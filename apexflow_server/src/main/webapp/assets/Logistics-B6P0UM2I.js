import{a4 as V,_ as fe,r as m,a as O,H as Q,o as _e,c as _,e as o,f as t,w as l,h as ve,i as ye,I as be,G as b,k as d,q as he,E as ke,l as $,a5 as Ce,t as c,a6 as xe,a7 as we,A as Ee,a8 as Te,a9 as Ve,p as u,B as x,d as w,aa as Le,C as Ae,D as Se,v as Ie,g as Ne,F as $e,K as ze,L as De,M as Me,ab as Be,P as Re,Q as Ue,R as He,S as Pe,$ as J}from"./index-C-PAn4RE.js";/* empty css                *//* empty css                      *//* empty css                        *//* empty css                    *//* empty css                 *//* empty css               */function W(g){return V({url:"/api/logistics",method:"get",params:g})}function Fe(){return V({url:"/api/logistics/stats",method:"get"})}function qe(g,f){return V({url:`/api/logistics/${g}/shipping`,method:"put",data:f})}function Ke(g,f){return V({url:`/api/logistics/${g}/status`,method:"put",data:{status:f}})}function je(g,f){return V({url:`/api/logistics/${g}`,method:"put",data:f})}function Ge(g){return V({url:`/api/logistics/${g}`,method:"delete"})}const Oe={class:"logistics-page"},Qe={class:"stat-content"},Je={class:"stat-icon",style:{background:"#fffbe6",color:"#faad14"}},We={class:"stat-info"},Xe={class:"stat-value"},Ye={class:"stat-content"},Ze={class:"stat-icon",style:{background:"#e6f7ff",color:"#1890ff"}},et={class:"stat-info"},tt={class:"stat-value"},st={class:"stat-content"},at={class:"stat-icon",style:{background:"#f6ffed",color:"#52c41a"}},lt={class:"stat-info"},nt={class:"stat-value"},ot={class:"card-header"},it={class:"header-actions"},rt={key:0,class:"data-stat"},dt={class:"stat-item"},ut={key:0,class:"stat-item"},pt={class:"highlight-text"},ct=["innerHTML"],gt=["innerHTML"],mt=["innerHTML"],ft={key:1},_t={key:0,style:{"font-size":"12px",color:"#67c23a"}},vt={key:1,style:{"font-size":"12px",color:"#409eff"}},yt={key:2,style:{"font-size":"12px",color:"#909399"}},bt={class:"pagination-container",style:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},ht={class:"dialog-footer"},kt={__name:"Logistics",setup(g){const f=m(!1),z=m("all"),L=m(""),A=m(1),D=m(10),h=m([]),E=O({pendingCount:0,shippedCount:0,deliveredCount:0}),S=async()=>{f.value=!0;try{const s=await Fe();console.log("ç‰©æµç»Ÿè®¡æ•°æ®",s),s&&s.success&&(E.pendingCount=s.data.pendingCount||0,E.shippedCount=s.data.shippedCount||0,E.deliveredCount=s.data.deliveredCount||0);const e=await W({page:1,pageSize:1});if(e&&e.success&&e.data){console.log("ç‰©æµåˆ—è¡¨åˆå§‹æ•°æ®",e);const i=e.data.totalCount||0;if(i>0){const r=await W({page:1,pageSize:i});console.log("ç‰©æµåˆ—è¡¨å…¨é‡æ•°æ®",r),r&&r.success&&r.data&&(h.value=r.data.data||[])}else h.value=[]}else h.value=[]}catch(s){console.error(s),b.error("è·å–ç‰©æµæ•°æ®å¤±è´¥")}finally{f.value=!1}},U=Q(()=>{let s=h.value;z.value!=="all"&&(s=s.filter(i=>i.status===z.value));const e=L.value.trim().toLowerCase();return e&&(s=s.filter(i=>{const r=String(i.orderId||"").toLowerCase(),k=String(i.trackingNumber||"").toLowerCase(),N=String(i.expressCompany||"").toLowerCase();return r.includes(e)||k.includes(e)||N.includes(e)})),s}),X=Q(()=>{const s=(A.value-1)*D.value,e=s+D.value;return U.value.slice(s,e)}),Y=()=>{A.value=1},Z=()=>{A.value=1},M=s=>h.value.filter(e=>e.status===s).length,H=s=>{if(!s)return"";const e=String(s),i=L.value.trim();if(!i)return e;const r=new RegExp(`(${i})`,"gi");return e.replace(r,'<span style="color: red; font-weight: bold;">$1</span>')},T=m(!1),I=m("ship"),P=m(!1),F=m(null),n=O({id:null,orderId:"",expressCompany:"",trackingNumber:"",senderAddress:"ä¸Šæµ·å¸‚ä¸­å¿ƒä»“"}),ee={expressCompany:[{required:!0,message:"è¯·é€‰æ‹©å¿«é€’å…¬å¸",trigger:"change"}],trackingNumber:[{required:!0,message:"è¯·è¾“å…¥è¿å•å·",trigger:"blur"}]},te=s=>{I.value="ship",n.id=s.id,n.orderId=s.orderId,n.expressCompany="",n.trackingNumber="",n.senderAddress="ä¸Šæµ·å¸‚ä¸­å¿ƒä»“",T.value=!0},se=s=>{I.value="edit",n.id=s.id,n.orderId=s.orderId,n.expressCompany=s.expressCompany,n.trackingNumber=s.trackingNumber,n.senderAddress=s.senderAddress,T.value=!0},ae=async()=>{F.value&&await F.value.validate(async s=>{if(s){P.value=!0;try{I.value==="ship"?(await qe(n.id,{expressCompany:n.expressCompany,trackingNumber:n.trackingNumber,senderAddress:n.senderAddress}),b.success("å‘è´§æˆåŠŸ")):(await je(n.id,{orderId:n.orderId,expressCompany:n.expressCompany,trackingNumber:n.trackingNumber,senderAddress:n.senderAddress,receiverAddress:""}),b.success("æ›´æ–°æˆåŠŸ")),T.value=!1,S()}catch(e){console.error(e),b.error(I.value==="ship"?"å‘è´§å¤±è´¥":"æ›´æ–°å¤±è´¥")}finally{P.value=!1}}})},le=s=>{J.confirm(`ç¡®è®¤è®¢å• ${s.orderId} çš„ç‰©æµå·²é€è¾¾?`,"æç¤º",{confirmButtonText:"ç¡®è®¤é€è¾¾",cancelButtonText:"å–æ¶ˆ",type:"success"}).then(async()=>{try{await Ke(s.id,"delivered"),b.success("çŠ¶æ€æ›´æ–°æˆåŠŸ"),S()}catch{b.error("æ“ä½œå¤±è´¥")}}).catch(()=>{})},ne=s=>{J.confirm("ç¡®å®šåˆ é™¤è¯¥ç‰©æµè®°å½•å—ï¼Ÿåˆ é™¤åæ— æ³•æ¢å¤ã€‚","è­¦å‘Š",{type:"warning"}).then(async()=>{try{await Ge(s.id),b.success("åˆ é™¤æˆåŠŸ"),S()}catch{b.error("åˆ é™¤å¤±è´¥")}}).catch(()=>{})},q=s=>{if(!s)return"-";if(Array.isArray(s)){const[e,i,r,k,N]=s,v=p=>p<10?"0"+p:p;return`${e}-${v(i)}-${v(r)} ${v(k)}:${v(N)}`}return String(s).replace("T"," ")},oe=s=>({pending:"å¾…å‘è´§",shipped:"è¿è¾“ä¸­",delivered:"å·²é€è¾¾"})[s]||s,ie=s=>({pending:"warning",shipped:"primary",delivered:"success"})[s]||"info";return _e(()=>{S()}),(s,e)=>{const i=ke,r=ye,k=he,N=ve,v=De,p=Ne,j=Le,B=Ve,re=Te,C=Se,G=Ie,de=Ae,ue=ze,R=Ue,y=Pe,pe=He,ce=Re,ge=be,me=$e;return d(),_("div",Oe,[e[24]||(e[24]=o("h2",null,"ğŸšš ç‰©æµç®¡ç†",-1)),t(N,{gutter:20,class:"stats-row"},{default:l(()=>[t(k,{span:6},{default:l(()=>[t(r,{shadow:"hover",class:"stat-card"},{default:l(()=>[o("div",Qe,[o("div",Je,[t(i,null,{default:l(()=>[t($(Ce))]),_:1})]),o("div",We,[o("div",Xe,c(E.pendingCount),1),e[9]||(e[9]=o("div",{class:"stat-label"},"å¾…å‘è´§",-1))])])]),_:1})]),_:1}),t(k,{span:6},{default:l(()=>[t(r,{shadow:"hover",class:"stat-card"},{default:l(()=>[o("div",Ye,[o("div",Ze,[t(i,null,{default:l(()=>[t($(xe))]),_:1})]),o("div",et,[o("div",tt,c(E.shippedCount),1),e[10]||(e[10]=o("div",{class:"stat-label"},"è¿è¾“ä¸­",-1))])])]),_:1})]),_:1}),t(k,{span:6},{default:l(()=>[t(r,{shadow:"hover",class:"stat-card"},{default:l(()=>[o("div",st,[o("div",at,[t(i,null,{default:l(()=>[t($(we))]),_:1})]),o("div",lt,[o("div",nt,c(E.deliveredCount),1),e[11]||(e[11]=o("div",{class:"stat-label"},"å·²é€è¾¾",-1))])])]),_:1})]),_:1})]),_:1}),t(r,{shadow:"never"},{header:l(()=>[o("div",ot,[o("div",it,[t(v,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=a=>L.value=a),placeholder:"æœç´¢è®¢å•å·/è¿å•å·/å¿«é€’å…¬å¸",style:{width:"300px","margin-right":"10px"},clearable:"",onInput:Z},{prefix:l(()=>[t(i,null,{default:l(()=>[t($(Me))]),_:1})]),_:1},8,["modelValue"]),t(p,{type:"primary",onClick:S},{default:l(()=>[t(i,{style:{"margin-right":"5px"}},{default:l(()=>[t($(Be))]),_:1}),e[12]||(e[12]=u(" åˆ·æ–° ",-1))]),_:1}),h.value.length>0?(d(),_("div",rt,[o("span",dt,[e[13]||(e[13]=u("æ€»è®°å½•: ",-1)),o("strong",null,c(h.value.length),1)]),L.value?(d(),_("span",ut,[e[14]||(e[14]=u("æœç´¢åŒ¹é…: ",-1)),o("strong",pt,c(U.value.length),1)])):w("",!0)])):w("",!0)])])]),default:l(()=>[t(re,{modelValue:z.value,"onUpdate:modelValue":e[1]||(e[1]=a=>z.value=a),type:"card",onTabChange:Y},{default:l(()=>[t(B,{label:"å¾…å‘è´§",name:"pending"},{label:l(()=>[e[15]||(e[15]=u(" å¾…å‘è´§ ",-1)),M("pending")>0?(d(),x(j,{key:0,value:M("pending"),type:"warning"},null,8,["value"])):w("",!0)]),_:1}),t(B,{label:"è¿è¾“ä¸­",name:"shipped"},{label:l(()=>[e[16]||(e[16]=u(" è¿è¾“ä¸­ ",-1)),M("shipped")>0?(d(),x(j,{key:0,value:M("shipped"),type:"primary"},null,8,["value"])):w("",!0)]),_:1}),t(B,{label:"å·²é€è¾¾",name:"delivered"}),t(B,{label:"å…¨éƒ¨",name:"all"})]),_:1},8,["modelValue"]),Ee((d(),x(de,{data:X.value,stripe:"",style:{width:"100%","margin-top":"10px"},"empty-text":"æš‚æ— ç‰©æµæ•°æ®"},{default:l(()=>[t(C,{label:"è®¢å•å·",width:"180"},{default:l(({row:a})=>[o("span",{innerHTML:H(a.orderId)},null,8,ct)]),_:1}),t(C,{label:"å¿«é€’å…¬å¸",width:"140"},{default:l(({row:a})=>[a.expressCompany?(d(),_("span",{key:0,innerHTML:H(a.expressCompany)},null,8,gt)):(d(),x(G,{key:1,type:"info",size:"small"},{default:l(()=>[...e[17]||(e[17]=[u("æœªå‘è´§",-1)])]),_:1}))]),_:1}),t(C,{label:"è¿å•å·",width:"180"},{default:l(({row:a})=>[a.trackingNumber?(d(),_("span",{key:0,innerHTML:H(a.trackingNumber)},null,8,mt)):(d(),_("span",ft,"-"))]),_:1}),t(C,{prop:"status",label:"çŠ¶æ€",width:"100"},{default:l(({row:a})=>[t(G,{type:ie(a.status),effect:"plain"},{default:l(()=>[u(c(oe(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(C,{label:"æ”¶è´§åœ°å€","min-width":"200","show-overflow-tooltip":""},{default:l(({row:a})=>[u(c(a.receiverAddress||"-"),1)]),_:1}),t(C,{label:"æ—¶é—´ä¿¡æ¯",width:"220"},{default:l(({row:a})=>[a.deliveredAt?(d(),_("div",_t," é€è¾¾: "+c(q(a.deliveredAt)),1)):a.shippedAt?(d(),_("div",vt," å‘è´§: "+c(q(a.shippedAt)),1)):(d(),_("div",yt," åˆ›å»º: "+c(q(a.createdAt)),1))]),_:1}),t(C,{label:"æ“ä½œ",width:"180",fixed:"right"},{default:l(({row:a})=>[a.status==="pending"?(d(),x(p,{key:0,type:"primary",size:"small",onClick:K=>te(a)},{default:l(()=>[...e[18]||(e[18]=[u(" å‘è´§ ",-1)])]),_:1},8,["onClick"])):w("",!0),a.status==="shipped"?(d(),x(p,{key:1,type:"success",size:"small",plain:"",onClick:K=>le(a)},{default:l(()=>[...e[19]||(e[19]=[u(" ç¡®è®¤é€è¾¾ ",-1)])]),_:1},8,["onClick"])):w("",!0),a.status!=="pending"?(d(),x(p,{key:2,type:"primary",link:"",size:"small",onClick:K=>se(a)},{default:l(()=>[...e[20]||(e[20]=[u(" ç¼–è¾‘ ",-1)])]),_:1},8,["onClick"])):w("",!0),t(p,{type:"danger",link:"",size:"small",onClick:K=>ne(a)},{default:l(()=>[...e[21]||(e[21]=[u(" åˆ é™¤ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,f.value]]),o("div",bt,[t(ue,{"current-page":A.value,"onUpdate:currentPage":e[2]||(e[2]=a=>A.value=a),"page-size":D.value,"onUpdate:pageSize":e[3]||(e[3]=a=>D.value=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",total:U.value.length},null,8,["current-page","page-size","total"])])]),_:1}),t(ge,{modelValue:T.value,"onUpdate:modelValue":e[8]||(e[8]=a=>T.value=a),title:I.value==="ship"?"è®¢å•å‘è´§":"ä¿®æ”¹ç‰©æµä¿¡æ¯",width:"500px"},{footer:l(()=>[o("span",ht,[t(p,{onClick:e[7]||(e[7]=a=>T.value=!1)},{default:l(()=>[...e[22]||(e[22]=[u("å–æ¶ˆ",-1)])]),_:1}),t(p,{type:"primary",loading:P.value,onClick:ae},{default:l(()=>[...e[23]||(e[23]=[u("ç¡®å®š",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(ce,{ref_key:"formRef",ref:F,model:n,rules:ee,"label-width":"100px"},{default:l(()=>[t(R,{label:"è®¢å•å·"},{default:l(()=>[o("span",null,c(n.orderId),1)]),_:1}),t(R,{label:"å¿«é€’å…¬å¸",prop:"expressCompany"},{default:l(()=>[t(pe,{modelValue:n.expressCompany,"onUpdate:modelValue":e[4]||(e[4]=a=>n.expressCompany=a),placeholder:"è¯·é€‰æ‹©å¿«é€’å…¬å¸",style:{width:"100%"}},{default:l(()=>[t(y,{label:"é¡ºä¸°é€Ÿè¿",value:"é¡ºä¸°é€Ÿè¿"}),t(y,{label:"äº¬ä¸œç‰©æµ",value:"äº¬ä¸œç‰©æµ"}),t(y,{label:"åœ†é€šé€Ÿé€’",value:"åœ†é€šé€Ÿé€’"}),t(y,{label:"ä¸­é€šå¿«é€’",value:"ä¸­é€šå¿«é€’"}),t(y,{label:"ç”³é€šå¿«é€’",value:"ç”³é€šå¿«é€’"}),t(y,{label:"éŸµè¾¾å¿«é€’",value:"éŸµè¾¾å¿«é€’"}),t(y,{label:"EMS",value:"EMS"}),t(y,{label:"å…¶ä»–",value:"å…¶ä»–"})]),_:1},8,["modelValue"])]),_:1}),t(R,{label:"è¿å•å·",prop:"trackingNumber"},{default:l(()=>[t(v,{modelValue:n.trackingNumber,"onUpdate:modelValue":e[5]||(e[5]=a=>n.trackingNumber=a),placeholder:"è¯·è¾“å…¥è¿å•å·"},null,8,["modelValue"])]),_:1}),t(R,{label:"å‘è´§åœ°å€",prop:"senderAddress"},{default:l(()=>[t(v,{modelValue:n.senderAddress,"onUpdate:modelValue":e[6]||(e[6]=a=>n.senderAddress=a),type:"textarea",rows:"2",placeholder:"å‘è´§äººåœ°å€"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},At=fe(kt,[["__scopeId","data-v-bb6d0e7e"]]);export{At as default};
