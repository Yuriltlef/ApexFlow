import{_ as ne,r as u,a as D,o as de,c as ue,e as s,f as t,w as l,h as re,i as ie,I as pe,G as f,k as E,q as ce,E as me,l as k,a5 as fe,t as g,a2 as _e,aj as ge,A as ve,B as L,C as ye,D as ke,ah as be,ak as we,p as d,d as G,al as Ve,v as Ce,g as Se,F as xe,K as Ee,L as ze,ai as he,M as Ue,R as Pe,S as De,O as Le,P as Re,Q as Fe,V as Ie,ac as $e,ad as Be,$ as Ne}from"./index-Ck2FL_5i.js";/* empty css                *//* empty css                       *//* empty css                      *//* empty css                        *//* empty css                        *//* empty css               */import{g as je,a as Te,d as qe,u as Me,c as Oe,b as Ae}from"./warehouse-iFvdmTwp.js";const Ke={class:"warehouse-page"},Ge={class:"stat-item"},Qe={class:"stat-icon",style:{color:"#1890ff",background:"#e6f7ff"}},We={class:"stat-content"},He={class:"stat-value"},Je={class:"stat-item"},Xe={class:"stat-icon",style:{color:"#52c41a",background:"#f6ffed"}},Ye={class:"stat-content"},Ze={class:"stat-value"},et={class:"stat-item"},tt={class:"stat-icon",style:{color:"#faad14",background:"#fffbe6"}},lt={class:"stat-content"},at={class:"stat-value"},ot={class:"table-actions"},st={class:"image-slot"},nt={class:"pagination-container"},dt={class:"dialog-footer"},ut={class:"dialog-footer"},rt={__name:"Warehouse",setup(it){const z=u(!1),R=u(0),F=u(0),I=u(0),h=u([]),$=u(0),c=D({page:1,pageSize:10,keyword:"",status:null}),r=async()=>{z.value=!0;try{const o=await je(c);o&&o.success&&(console.log("è·å–å•†å“åˆ—è¡¨æ•°æ®",o.data),h.value=o.data.products||[],$.value=o.data.totalCount||0,R.value=o.data.totalCount||0,F.value=h.value.reduce((e,v)=>e+v.stock,0))}catch(o){console.error(o),f.error("è·å–å•†å“åˆ—è¡¨å¤±è´¥")}finally{z.value=!1}},B=async()=>{try{const o=await Te(10);o&&o.success&&(I.value=o.data.count||0)}catch(o){console.error("è·å–ä½åº“å­˜ç»Ÿè®¡å¤±è´¥",o)}},b=u(!1),w=u(!1),y=u(!1),N=u(null),n=D({id:null,name:"",category:"",price:0,stock:0,image:"",status:1}),Q={name:[{required:!0,message:"è¯·è¾“å…¥å•†å“åç§°",trigger:"blur"}],category:[{required:!0,message:"è¯·è¾“å…¥åˆ†ç±»",trigger:"blur"}],price:[{required:!0,message:"è¯·è¾“å…¥ä»·æ ¼",trigger:"blur"}]},j=(o=null)=>{o?(w.value=!0,Object.assign(n,o)):(w.value=!1,Object.assign(n,{id:null,name:"",category:"",price:0,stock:0,image:"",status:1})),b.value=!0},W=async()=>{await N.value.validate(async o=>{if(o){y.value=!0;try{w.value?(await Me(n),f.success("æ›´æ–°æˆåŠŸ")):(await Oe(n),f.success("åˆ›å»ºæˆåŠŸ")),b.value=!1,r()}catch{f.error("æ“ä½œå¤±è´¥")}finally{y.value=!1}}})},H=o=>{Ne.confirm(`ç¡®å®šä¸‹æ¶å•†å“ "${o.name}" å—ï¼Ÿ`,"æç¤º",{type:"warning"}).then(async()=>{try{await qe(o.id),f.success("å·²ä¸‹æ¶"),r()}catch{f.error("æ“ä½œå¤±è´¥")}}).catch(()=>{})},V=u(!1),S=u(null),i=D({newStock:0,reason:""}),J=o=>{S.value=o,i.newStock=o.stock,i.reason="",V.value=!0},X=async()=>{if(!i.reason){f.warning("è¯·è¾“å…¥è°ƒæ•´åŸå› ");return}y.value=!0;try{await Ae(S.value.id,{newStock:i.newStock,reason:i.reason}),f.success("åº“å­˜è°ƒæ•´æˆåŠŸ"),V.value=!1,r(),B()}catch{f.error("è°ƒæ•´å¤±è´¥")}finally{y.value=!1}},Y=o=>Number(o||0).toFixed(2);return de(()=>{r(),B()}),(o,e)=>{const v=me,x=ie,U=ce,Z=re,C=ze,T=De,ee=Pe,m=Se,_=ke,te=be,q=Ce,le=ye,ae=Ee,p=Fe,P=Ie,M=Be,oe=$e,O=Re,A=pe,se=xe;return E(),ue("div",Ke,[e[32]||(e[32]=s("h2",null,"ğŸ“¦ åº“å­˜ç®¡ç†",-1)),t(Z,{gutter:16,class:"warehouse-stats"},{default:l(()=>[t(U,{span:8},{default:l(()=>[t(x,{shadow:"hover"},{default:l(()=>[s("div",Ge,[s("div",Qe,[t(v,{size:"24"},{default:l(()=>[t(k(fe))]),_:1})]),s("div",We,[s("div",He,g(R.value),1),e[17]||(e[17]=s("div",{class:"stat-label"},"å•†å“æ€»æ•°",-1))])])]),_:1})]),_:1}),t(U,{span:8},{default:l(()=>[t(x,{shadow:"hover"},{default:l(()=>[s("div",Je,[s("div",Xe,[t(v,{size:"24"},{default:l(()=>[t(k(_e))]),_:1})]),s("div",Ye,[s("div",Ze,g(F.value),1),e[18]||(e[18]=s("div",{class:"stat-label"},"å½“å‰åº“å­˜æ€»é‡",-1))])])]),_:1})]),_:1}),t(U,{span:8},{default:l(()=>[t(x,{shadow:"hover"},{default:l(()=>[s("div",et,[s("div",tt,[t(v,{size:"24"},{default:l(()=>[t(k(ge))]),_:1})]),s("div",lt,[s("div",at,g(I.value),1),e[19]||(e[19]=s("div",{class:"stat-label"},"ä½åº“å­˜é¢„è­¦",-1))])])]),_:1})]),_:1})]),_:1}),t(x,{shadow:"never"},{header:l(()=>[s("div",ot,[t(C,{modelValue:c.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>c.keyword=a),placeholder:"æœç´¢å•†å“åç§°/ç±»åˆ«",style:{width:"250px","margin-right":"10px"},clearable:"",onClear:r,onKeyup:he(r,["enter"])},{prefix:l(()=>[t(v,null,{default:l(()=>[t(k(Ue))]),_:1})]),_:1},8,["modelValue"]),t(ee,{modelValue:c.status,"onUpdate:modelValue":e[1]||(e[1]=a=>c.status=a),placeholder:"çŠ¶æ€",clearable:"",style:{width:"120px","margin-right":"10px"},onChange:r},{default:l(()=>[t(T,{label:"ä¸Šæ¶",value:1}),t(T,{label:"ä¸‹æ¶",value:0})]),_:1},8,["modelValue"]),t(m,{type:"primary",onClick:r},{default:l(()=>[...e[20]||(e[20]=[d("æœç´¢",-1)])]),_:1}),t(m,{type:"success",icon:k(Le),onClick:e[2]||(e[2]=a=>j())},{default:l(()=>[...e[21]||(e[21]=[d("æ–°å¢å•†å“",-1)])]),_:1},8,["icon"])])]),default:l(()=>[ve((E(),L(le,{data:h.value,stripe:"",style:{width:"100%"}},{default:l(()=>[t(_,{prop:"id",label:"ID",width:"80"}),t(_,{label:"å•†å“å›¾ç‰‡",width:"100"},{default:l(({row:a})=>[t(te,{style:{width:"50px",height:"50px","border-radius":"4px"},src:a.image,fit:"cover","preview-src-list":[a.image],"preview-teleported":""},{error:l(()=>[s("div",st,[t(v,null,{default:l(()=>[t(k(we))]),_:1})])]),_:1},8,["src","preview-src-list"])]),_:1}),t(_,{prop:"name",label:"å•†å“åç§°","min-width":"150","show-overflow-tooltip":""}),t(_,{prop:"category",label:"åˆ†ç±»",width:"100"}),t(_,{prop:"price",label:"ä»·æ ¼",width:"120"},{default:l(({row:a})=>[d("Â¥"+g(Y(a.price)),1)]),_:1}),t(_,{prop:"stock",label:"å½“å‰åº“å­˜",width:"120"},{default:l(({row:a})=>[s("span",{style:Ve(a.stock<=10?"color: #f56c6c; font-weight: bold;":"")},g(a.stock),5),a.stock<=10?(E(),L(q,{key:0,size:"small",type:"danger",style:{"margin-left":"5px"}},{default:l(()=>[...e[22]||(e[22]=[d("ç´§ç¼º",-1)])]),_:1})):G("",!0)]),_:1}),t(_,{prop:"status",label:"çŠ¶æ€",width:"100"},{default:l(({row:a})=>[t(q,{type:a.status===1?"success":"info"},{default:l(()=>[d(g(a.status===1?"ä¸Šæ¶":"ä¸‹æ¶"),1)]),_:2},1032,["type"])]),_:1}),t(_,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:l(({row:a})=>[t(m,{type:"primary",link:"",size:"small",onClick:K=>j(a)},{default:l(()=>[...e[23]||(e[23]=[d("ç¼–è¾‘",-1)])]),_:1},8,["onClick"]),t(m,{type:"warning",link:"",size:"small",onClick:K=>J(a)},{default:l(()=>[...e[24]||(e[24]=[d("åº“å­˜è°ƒæ•´",-1)])]),_:1},8,["onClick"]),t(m,{type:"danger",link:"",size:"small",onClick:K=>H(a)},{default:l(()=>[...e[25]||(e[25]=[d("ä¸‹æ¶",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[se,z.value]]),s("div",nt,[t(ae,{"current-page":c.page,"onUpdate:currentPage":e[3]||(e[3]=a=>c.page=a),"page-size":c.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>c.pageSize=a),"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",total:$.value,onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","total"])])]),_:1}),t(A,{modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=a=>b.value=a),title:w.value?"ç¼–è¾‘å•†å“":"æ–°å¢å•†å“",width:"500px"},{footer:l(()=>[s("span",dt,[t(m,{onClick:e[11]||(e[11]=a=>b.value=!1)},{default:l(()=>[...e[28]||(e[28]=[d("å–æ¶ˆ",-1)])]),_:1}),t(m,{type:"primary",loading:y.value,onClick:W},{default:l(()=>[...e[29]||(e[29]=[d("ç¡®å®š",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(O,{ref_key:"productFormRef",ref:N,model:n,rules:Q,"label-width":"100px"},{default:l(()=>[t(p,{label:"å•†å“åç§°",prop:"name"},{default:l(()=>[t(C,{modelValue:n.name,"onUpdate:modelValue":e[5]||(e[5]=a=>n.name=a)},null,8,["modelValue"])]),_:1}),t(p,{label:"åˆ†ç±»",prop:"category"},{default:l(()=>[t(C,{modelValue:n.category,"onUpdate:modelValue":e[6]||(e[6]=a=>n.category=a),placeholder:"å¦‚ï¼šæ‰‹æœºã€æ•°ç "},null,8,["modelValue"])]),_:1}),t(p,{label:"ä»·æ ¼",prop:"price"},{default:l(()=>[t(P,{modelValue:n.price,"onUpdate:modelValue":e[7]||(e[7]=a=>n.price=a),precision:2,step:.1,min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),w.value?G("",!0):(E(),L(p,{key:0,label:"åˆå§‹åº“å­˜",prop:"stock"},{default:l(()=>[t(P,{modelValue:n.stock,"onUpdate:modelValue":e[8]||(e[8]=a=>n.stock=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})),t(p,{label:"å•†å“å›¾ç‰‡",prop:"image"},{default:l(()=>[t(C,{modelValue:n.image,"onUpdate:modelValue":e[9]||(e[9]=a=>n.image=a),placeholder:"è¯·è¾“å…¥å›¾ç‰‡URL"},null,8,["modelValue"])]),_:1}),t(p,{label:"çŠ¶æ€"},{default:l(()=>[t(oe,{modelValue:n.status,"onUpdate:modelValue":e[10]||(e[10]=a=>n.status=a)},{default:l(()=>[t(M,{label:1},{default:l(()=>[...e[26]||(e[26]=[d("ä¸Šæ¶",-1)])]),_:1}),t(M,{label:0},{default:l(()=>[...e[27]||(e[27]=[d("ä¸‹æ¶",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(A,{modelValue:V.value,"onUpdate:modelValue":e[16]||(e[16]=a=>V.value=a),title:"åº“å­˜ç›˜ç‚¹è°ƒæ•´",width:"400px"},{footer:l(()=>[s("span",ut,[t(m,{onClick:e[15]||(e[15]=a=>V.value=!1)},{default:l(()=>[...e[30]||(e[30]=[d("å–æ¶ˆ",-1)])]),_:1}),t(m,{type:"primary",loading:y.value,onClick:X},{default:l(()=>[...e[31]||(e[31]=[d("ç¡®å®šè°ƒæ•´",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(O,{ref:"stockFormRef",model:i,"label-width":"100px"},{default:l(()=>[t(p,{label:"å•†å“åç§°"},{default:l(()=>[s("span",null,g(S.value?.name),1)]),_:1}),t(p,{label:"å½“å‰åº“å­˜"},{default:l(()=>[s("span",null,g(S.value?.stock),1)]),_:1}),t(p,{label:"è°ƒæ•´ååº“å­˜",prop:"newStock"},{default:l(()=>[t(P,{modelValue:i.newStock,"onUpdate:modelValue":e[13]||(e[13]=a=>i.newStock=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(p,{label:"è°ƒæ•´åŸå› ",prop:"reason"},{default:l(()=>[t(C,{modelValue:i.reason,"onUpdate:modelValue":e[14]||(e[14]=a=>i.reason=a),type:"textarea",placeholder:"å¦‚ï¼šç›˜ç‚¹å·®å¼‚ã€æŸè€—"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},kt=ne(rt,[["__scopeId","data-v-37a95bb8"]]);export{kt as default};
