# ApexFlow - ç”µå•†ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ

![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)
![Vue.js](https://img.shields.io/badge/Vue.js-3.x-42b883.svg)
![Java](https://img.shields.io/badge/Java-17-007396.svg)
![Tomcat](https://img.shields.io/badge/Tomcat-9.x-F8DC75.svg)
![MySQL](https://img.shields.io/badge/MySQL-8.0+-4479A1.svg)
![Build Status](https://img.shields.io/badge/build-passing-brightgreen.svg)

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

**ApexFlow** æ˜¯ä¸€ä¸ªå¼€æºçš„ç”µå•†ä¿¡æ¯ç®¡ç†ç³»ç»Ÿï¼Œä¸“ä¸ºä¸­å°å‹ç”µå•†å•†å®¶è®¾è®¡ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯ä½¿ç”¨Vue 3.xï¼Œåç«¯åŸºäºJava ServletæŠ€æœ¯ï¼Œç”±Tomcatç›´æ¥æ‰˜ç®¡éƒ¨ç½²ï¼Œæ— éœ€Nginxç­‰åå‘ä»£ç†æœåŠ¡å™¨ã€‚é¡¹ç›®éµå¾ªGPL-3.0å¼€æºåè®®ï¼Œå®Œå…¨å…è´¹ä½¿ç”¨å’Œä¿®æ”¹ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ä¸€ä½“åŒ–éƒ¨ç½²**ï¼šå‰åç«¯ç»Ÿä¸€ç”±Tomcatæ‰˜ç®¡ï¼Œç®€åŒ–éƒ¨ç½²æµç¨‹
- **æ¨¡å—åŒ–ç®¡ç†**ï¼šå…­å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œè¦†ç›–ç”µå•†è¿è¥å…¨æµç¨‹
- **ç°ä»£åŒ–ç•Œé¢**ï¼šåŸºäºVue 3 + Element Plusçš„å“åº”å¼è®¾è®¡
- **RESTful API**ï¼šæ ‡å‡†åŒ–æ¥å£è®¾è®¡ï¼Œä¾¿äºé›†æˆå’Œæ‰©å±•
- **å¼€æºè‡ªç”±**ï¼šGPL-3.0åè®®ï¼Œæ”¯æŒäºŒæ¬¡å¼€å‘å’Œå•†ä¸šåº”ç”¨

## ğŸ—‚ï¸ åŠŸèƒ½æ¨¡å—

| æ¨¡å— | æ ¸å¿ƒåŠŸèƒ½ | çŠ¶æ€ |
|------|----------|------|
| **è®¢å•ç®¡ç†** | è®¢å•åˆ›å»º/æŸ¥è¯¢/ç­›é€‰ï¼Œè®¢å•çŠ¶æ€è·Ÿè¸ªï¼Œæ‰¹é‡æ“ä½œ | âœ… å·²å®Œæˆ |
| **ç‰©æµç®¡ç†** | ç‰©æµå…¬å¸å¯¹æ¥ï¼Œè¿å•ç®¡ç†ï¼Œç‰©æµè½¨è¿¹æŸ¥è¯¢ | âœ… å·²å®Œæˆ |
| **å”®åç®¡ç†** | é€€è´§/æ¢è´§ç”³è¯·å¤„ç†ï¼Œé€€æ¬¾ç®¡ç†ï¼Œå”®åè®°å½• | âœ… å·²å®Œæˆ |
| **è¯„ä»·ç®¡ç†** | å•†å“è¯„ä»·æŸ¥çœ‹ï¼Œå›å¤è¯„ä»·ï¼Œè¯„ä»·æ•°æ®åˆ†æ | âœ… å·²å®Œæˆ |
| **ä»“åº“ç®¡ç†** | åº“å­˜ç®¡ç†ï¼Œå…¥åº“/å‡ºåº“è®°å½•ï¼Œåº“å­˜é¢„è­¦ | âœ… å·²å®Œæˆ |
| **è´¢åŠ¡ç®¡ç†** | æ”¶æ”¯ç»Ÿè®¡ï¼Œè´¢åŠ¡æŠ¥è¡¨ï¼Œè´¦å•ç®¡ç† | âœ… å·²å®Œæˆ |

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

**å‰ç«¯ (Vue 3.x)**
- **æ¡†æ¶**: Vue 3.x (ç»„åˆå¼API)
- **UIç»„ä»¶åº“**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±ç®¡ç†**: Vue Router 4
- **HTTPå®¢æˆ·ç«¯**: Axios
- **æ„å»ºå·¥å…·**: Vite

**åç«¯ (Java Servlet)**
- **æœåŠ¡å™¨**: Apache Tomcat 9.x
- **Javaç‰ˆæœ¬**: JDK 17
- **Webæ¡†æ¶**: Servlet
- **æ•°æ®åº“**: MySQL 8.0+
- **è¿æ¥æ± **: HikariCP
- **JSONå¤„ç†**: Jackson
- **æ—¥å¿—æ¡†æ¶**: Log4j2

**å¼€å‘å·¥å…·**
- **IDE**: IntelliJ IDEA  + VS Code
- **æ„å»ºå·¥å…·**: Maven 3.6+
- **æ•°æ®åº“å·¥å…·**: MySQL Workbench
- **ç‰ˆæœ¬æ§åˆ¶**: Git

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æµè§ˆå™¨å®¢æˆ·ç«¯ (Vue SPA)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTP/HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Apache Tomcat 9.x            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚      apexflow-web (é™æ€èµ„æº)     â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ index.html                 â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ static/                    â”‚   â”‚
â”‚   â”‚  â””â”€â”€ assets/                    â”‚   â”‚
â”‚   â”‚                                 â”‚   â”‚
â”‚   â”‚      apexflow-server (Java)     â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ Servlet Controllers        â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ DAO/Service å±‚             â”‚   â”‚
â”‚   â”‚  â””â”€â”€ Filters/                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                  â”‚                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚           â”‚    MySQL     â”‚              â”‚
â”‚           â”‚   æ•°æ®åº“      â”‚              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## é¡¹ç›®ç»“æ„æ ‘
```
ApexFlow/
â”œâ”€â”€ readme.md                     # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ apexflow_server/              # æœåŠ¡å™¨ç«¯ä»£ç 
â”‚   â”œâ”€â”€ .smarttomcat/ApexFlow/conf/web.xml  # Tomcaté…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/com/apex/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ config/FrontendRouterFilter.java  # å‰ç«¯è·¯ç”±è¿‡æ»¤é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IReviewDAO.java           # è¯„ä»·æ•°æ®è®¿é—®æ¥å£
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ProductDAO.java           # å•†å“æ•°æ®è®¿é—®ç±»
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dto/OrderWithItemsResponse.java  # è®¢å•åŠè®¢å•é¡¹å“åº”DTO
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SystemUser.java           # ç³»ç»Ÿç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ service/UserService.java      # ç”¨æˆ·æœåŠ¡ç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ util/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoggingConnection.java        # æ—¥å¿—è¿æ¥å·¥å…·ç±»
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoggingStatement.java         # æ—¥å¿—è¯­å¥å·¥å…·ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ webapp/assets/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ strings-BdNYIbtM.js               # å‰ç«¯å­—ç¬¦ä¸²å¤„ç†å·¥å…·
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ strings-BZDa8bsY.js               # å‰ç«¯å­—ç¬¦ä¸²å¤„ç†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ test/java/
â”‚   â”‚   â”‚   â”œâ”€â”€ AfterSalesDAOTest.java                # å”®åDAOæµ‹è¯•ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderItemDAOTest.java                 # è®¢å•é¡¹DAOæµ‹è¯•ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderServiceTest.java                 # è®¢å•æœåŠ¡æµ‹è¯•ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ UserDAOTest.java                      # ç”¨æˆ·DAOæµ‹è¯•ç±»
â”œâ”€â”€ apexflow_web/                 # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ package-lock.json         # npmä¾èµ–é”æ–‡ä»¶
â”‚   â”œâ”€â”€ src/components/layout/Sidebar.vue  # ä¾§è¾¹æ ç»„ä»¶
```


## æ ¸å¿ƒè¡¨æ ¼è¯´æ˜

### 1. ä»£ç æäº¤ç±»å‹è¯´æ˜
| æäº¤ç±»å‹ | æè¿° |
|----------|------|
| `feat` | æ–°å¢åŠŸèƒ½ |
| `fix` | ä¿®å¤bug |
| `docs` | æ–‡æ¡£æ›´æ–° |
| `style` | ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“ä»£ç é€»è¾‘ï¼‰ |
| `refactor` | ä»£ç é‡æ„ï¼ˆæ—¢ä¸æ˜¯æ–°å¢åŠŸèƒ½ä¹Ÿä¸æ˜¯ä¿®bugï¼‰ |
| `test` | æµ‹è¯•ç›¸å…³ä»£ç ï¼ˆæ–°å¢/ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ï¼‰ |
| `chore` | æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨ï¼ˆå¦‚ä¾èµ–æ›´æ–°ã€é…ç½®ä¿®æ”¹ï¼‰ |


### 2. è®¢å•çŠ¶æ€è½¬æ¢è§„åˆ™ï¼ˆæµ‹è¯•éªŒè¯ï¼‰
| åŸçŠ¶æ€ | ç›®æ ‡çŠ¶æ€ | è¯´æ˜ |
|--------|----------|------|
| 1ï¼ˆå¾…æ”¯ä»˜ï¼‰ | 2ï¼ˆå·²æ”¯ä»˜ï¼‰ | æ”¯ä»˜æˆåŠŸåçŠ¶æ€è½¬æ¢ï¼Œè§¦å‘æ”¶å…¥è®°å½•åˆ›å»º |
| 2ï¼ˆå·²æ”¯ä»˜ï¼‰ | 3ï¼ˆå·²å‘è´§ï¼‰ | å•†å®¶å‘è´§åçŠ¶æ€è½¬æ¢ |
| 3ï¼ˆå·²å‘è´§ï¼‰ | 4ï¼ˆå·²å®Œæˆï¼‰ | ä¹°å®¶ç¡®è®¤æ”¶è´§åçŠ¶æ€è½¬æ¢ |
| 1ï¼ˆå¾…æ”¯ä»˜ï¼‰ | 5ï¼ˆå·²å–æ¶ˆï¼‰ | è®¢å•å–æ¶ˆï¼Œè§¦å‘åº“å­˜å›è¡¥ |


## æ ¸å¿ƒåŠŸèƒ½ç¤ºä¾‹

### 1. è®¢å•é¡¹æ‰¹é‡åˆ›å»ºç¤ºä¾‹ï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰
```java
private static @NotNull List<OrderItem> getOrderItems() {
    List<OrderItem> batchItems = new ArrayList<>();

    OrderItem item1 = new OrderItem();
    item1.setOrderId("ITEM_BATCH_001");
    item1.setProductId(1);
    item1.setProductName("iPhone 14 Pro");
    item1.setQuantity(2);
    item1.setPrice(new BigDecimal("7999.00"));
    item1.setSubtotal(new BigDecimal("15998.00"));

    OrderItem item2 = new OrderItem();
    item2.setOrderId("ITEM_BATCH_001");
    item2.setProductId(2);
    item2.setProductName("MacBook Pro 16è‹±å¯¸");
    item2.setQuantity(1);
    item2.setPrice(new BigDecimal("18999.00"));
    item2.setSubtotal(new BigDecimal("18999.00"));

    batchItems.add(item1);
    batchItems.add(item2);
    return batchItems;
}

// æ‰¹é‡åˆ›å»ºè°ƒç”¨
boolean result = orderItemDAO.createBatch(batchItems);
```


### 2. ç”¨æˆ·æƒé™è·å–ç¤ºä¾‹ï¼ˆæœåŠ¡å±‚ä»£ç ï¼‰
```java
public Map<String, Object> getPermissions(String token) {
    Map<String, Object> result = new HashMap<>();

    // éªŒè¯Token
    if (!JwtUtil.validateToken(token)) {
        result.put("success", false);
        result.put("message", "æ— æ•ˆçš„Token");
        return result;
    }

    Integer userId = JwtUtil.getUserIdFromToken(token);
    SystemUser user = userDAO.getPermissions(userId);
    
    // æ„å»ºæƒé™å“åº”
    Map<String, Object> permissions = new HashMap<>();
    permissions.put("isAdmin", user.getAdmin());
    permissions.put("canManageOrder", user.getCanManageOrder());
    permissions.put("canManageLogistics", user.getCanManageLogistics());
    permissions.put("canManageReview", user.getCanManageReview());
    // ... å…¶ä»–æƒé™
    
    result.put("success", true);
    result.put("data", permissions);
    return result;
}
```


### 3. å‰ç«¯ä¾§è¾¹æ æ ·å¼ç¤ºä¾‹ï¼ˆVueç»„ä»¶CSSï¼‰
```css
/* æŠ˜å èœå•tooltipæ ·å¼ */
.sidebar-menu.el-menu--collapse :deep(.el-tooltip) {
  font-size: 12px !important;
  padding: 4px 8px !important;
  background: #24292e !important;
  color: white !important;
  border: none !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
  border-radius: 4px !important;
  max-width: 200px !important;
}

/* å¾½ç« æ ·å¼ */
.badge-wrapper {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  padding: 0px;
}
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Java**: JDK 17 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Tomcat**: Apache Tomcat 9.x
- **MySQL**: MySQL 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Node.js**: 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **Maven**: 3.6+ï¼ˆç”¨äºåç«¯æ„å»ºï¼‰

### 1. æ•°æ®åº“åˆå§‹åŒ–

```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE apexflow CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºç”¨æˆ·å¹¶æˆæƒï¼ˆå¯é€‰ï¼‰
CREATE USER 'apexflow'@'localhost' IDENTIFIED BY 'apexflow123';
GRANT ALL PRIVILEGES ON apexflow.* TO 'apexflow'@'localhost';
FLUSH PRIVILEGES;

-- å¯¼å…¥è¡¨ç»“æ„ï¼ˆSQLæ–‡ä»¶ä½äº /apexflow_dbï¼‰
-- mysql -u root -p apexflow < /apexflow_db/xxx.sql
```

### 2. é¡¹ç›®æ„å»ºä¸éƒ¨ç½²

#### æ–¹æ¡ˆä¸€ï¼šä¸€é”®æ„å»ºéƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/apexflow.git
cd apexflow

# 2. å®‰è£…å‰ç«¯ä¾èµ–å¹¶æ„å»º
cd apexflow-web
npm install
npm run build  # æ„å»ºåˆ°åç«¯é¡¹ç›®çš„webappç›®å½•

# 3. æ„å»ºåç«¯é¡¹ç›®
cd ../apexflow-server
mvn clean package

# 4. éƒ¨ç½²åˆ°Tomcat
# å°†target/apexflow.warå¤åˆ¶åˆ°Tomcatçš„webappsç›®å½•
cp target/apexflow.war /path/to/tomcat/webapps/

# 5. å¯åŠ¨Tomcat
/path/to/tomcat/bin/startup.sh
```

#### æ–¹æ¡ˆäºŒï¼šå¼€å‘æ¨¡å¼è¿è¡Œ

```bash
# 1. å¯åŠ¨åç«¯æœåŠ¡ï¼ˆåœ¨apexflow-serverç›®å½•ï¼‰
mvn tomcat9:run  # æˆ–ä½¿ç”¨IDEå¯åŠ¨

# 2. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆåœ¨apexflow-webç›®å½•ï¼‰
npm run serve

# 3. è®¿é—®åº”ç”¨
# å‰ç«¯å¼€å‘åœ°å€ï¼šhttp://localhost:3000
# åç«¯APIåœ°å€ï¼šhttp://localhost:8080
```

## ğŸ“Š æ•°æ®åº“è®¾è®¡

ä¸»è¦æ•°æ®è¡¨ç¤ºä¾‹ï¼š

```sql
CREATE TABLE apexflow_order (
    id VARCHAR(50) PRIMARY KEY COMMENT 'è®¢å•å·ï¼Œæ ¼å¼å¦‚ORDER20231215001',
    user_id INT NOT NULL COMMENT 'ä¸‹å•ç”¨æˆ·ID',
    total_amount DECIMAL(10,2) NOT NULL COMMENT 'è®¢å•æ€»é‡‘é¢',
    status TINYINT NOT NULL COMMENT 'çŠ¶æ€ï¼š1-å¾…æ”¯ä»˜ï¼Œ2-å·²æ”¯ä»˜ï¼Œ3-å·²å‘è´§ï¼Œ4-å·²å®Œæˆï¼Œ5-å·²å–æ¶ˆ',
    payment_method VARCHAR(20) COMMENT 'æ”¯ä»˜æ–¹å¼ï¼šalipay,wxpayç­‰',
    address_id INT COMMENT 'æ”¶è´§åœ°å€ID',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'ä¸‹å•æ—¶é—´',
    paid_at DATETIME COMMENT 'æ”¯ä»˜æ—¶é—´',
    shipped_at DATETIME COMMENT 'å‘è´§æ—¶é—´',
    completed_at DATETIME COMMENT 'å®Œæˆæ—¶é—´'
) COMMENT='è®¢å•ä¸»è¡¨';

CREATE TABLE apexflow_order_item (
    id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'è®¢å•é¡¹ID',
    order_id VARCHAR(50) NOT NULL COMMENT 'å…³è”è®¢å•å·',
    product_id INT NOT NULL COMMENT 'å•†å“ID',
    product_name VARCHAR(100) NOT NULL COMMENT 'å•†å“åç§°ï¼ˆä¸‹å•æ—¶çš„å¿«ç…§ï¼‰',
    quantity INT NOT NULL COMMENT 'è´­ä¹°æ•°é‡',
    price DECIMAL(10,2) NOT NULL COMMENT 'ä¸‹å•æ—¶å•ä»·',
    subtotal DECIMAL(10,2) NOT NULL COMMENT 'å°è®¡é‡‘é¢',
    FOREIGN KEY (order_id) REFERENCES apexflow_order(id),
    FOREIGN KEY (product_id) REFERENCES apexflow_product(id)
) COMMENT='è®¢å•å•†å“æ˜ç»†è¡¨';
```

å®Œæ•´æ•°æ®åº“è„šæœ¬è¯·æŸ¥çœ‹ `apexflow_db` ç›®å½•ã€‚

## ğŸ”Œ ç”¨æˆ·APIæ¥å£æ–‡æ¡£ï¼ˆç”¨æˆ·æ¨¡å—ï¼‰

åŸºäºç°æœ‰æ•°æ®åº“è¡¨ `apexflow_system_user` å®ç°å››ä¸ªAPIï¼Œä¸åˆ›å»ºæ–°è¡¨ï¼Œä¸è¿”å›å†—ä½™ä¿¡æ¯ã€‚

### 1. ç”¨æˆ·ç™»å½•
**POST** `/api/auth/login`

#### æµç¨‹
```
å®¢æˆ·ç«¯ (HTTPS) â†’ åç«¯æ¥æ”¶æ˜æ–‡å¯†ç  â†’ æŸ¥è¯¢ç”¨æˆ· â†’ åŠ ç›å“ˆå¸ŒéªŒè¯ â†’ è¿”å›Token
```

#### è¯·æ±‚
```json
{
  "username": "admin",
  "password": "your_password"
}
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "data": {
    "token": "jwt_token_here",
    "user": {
      "id": 1,
      "username": "admin",
      "realName": "ç³»ç»Ÿç®¡ç†å‘˜",
      "isAdmin": true
    }
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
}
```

---

### 2. è·å–ç”¨æˆ·æƒé™
**GET** `/api/user/permissions`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Token â†’ TokenéªŒè¯ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›æƒé™å­—æ®µ
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
```

#### å“åº”
```json
{
  "success": true,
  "data": {
    "isAdmin": true,
    "canManageOrder": true,
    "canManageLogistics": true,
    "canManageAfterSales": true,
    "canManageReview": true,
    "canManageInventory": true,
    "canManageIncome": true
  }
}
```

---

### 3. ä¿®æ”¹ä¸ªäººä¿¡æ¯
**PUT** `/api/user/profile`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Tokenå’Œæ›´æ–°æ•°æ® â†’ TokenéªŒè¯ â†’ æ•°æ®éªŒè¯ â†’ æ›´æ–°æ•°æ®åº“
```

#### è¯·æ±‚
```json
{
  "realName": "æ–°å§“å",
  "email": "new@email.com",
  "phone": "13800138001"
}
```
*è‡³å°‘æä¾›ä¸€ä¸ªå­—æ®µ*

#### å“åº”
```json
{
  "success": true,
  "data": {
    "id": 1,
    "realName": "æ–°å§“å",
    "email": "new@email.com",
    "phone": "13800138001"
  }
}
```

---

### 4. ç”¨æˆ·ç™»å‡º
**POST** `/api/auth/logout`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Token â†’ TokenéªŒè¯ â†’ å®¢æˆ·ç«¯ä¸¢å¼ƒTokenï¼ˆæ— çŠ¶æ€å®ç°ï¼‰
```

#### å“åº”
```json
{
  "success": true
}
```

## ğŸ”Œ APIæ¥å£æ–‡æ¡£ï¼ˆè´¢åŠ¡æ”¶æ”¯æ¨¡å—ï¼‰

### 1. åˆ›å»ºè´¢åŠ¡è®°å½•
**POST** `/api/income`

#### æµç¨‹
```
å®¢æˆ·ç«¯ (HTTPS) â†’ éªŒè¯Token â†’ éªŒè¯è¾“å…¥æ•°æ® â†’ åˆ›å»ºè´¢åŠ¡è®°å½• â†’ è¿”å›åˆ›å»ºç»“æœ
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
Content-Type: application/json
```

#### è¯·æ±‚
```json
{
  "orderId": "ORDER20231201001",
  "type": "income",
  "amount": 7999.00,
  "paymentMethod": "alipay",
  "status": 2,
  "transactionTime": "2023-12-01 09:05:00",
  "remark": "iPhone 14 Proé”€å”®æ¬¾"
}
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡è®°å½•åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 1,
    "orderId": "ORDER20231201001",
    "type": "income",
    "amount": 7999.00,
    "paymentMethod": "alipay",
    "status": 2,
    "transactionTime": "2023-12-01 09:05:00",
    "remark": "iPhone 14 Proé”€å”®æ¬¾"
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "è¾“å…¥æ•°æ®éªŒè¯å¤±è´¥",
  "data": {
    "orderId": "è®¢å•å·ä¸èƒ½ä¸ºç©º"
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 2. è·å–è´¢åŠ¡è®°å½•è¯¦æƒ…
**GET** `/api/income/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›è®°å½•è¯¦æƒ…
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
```

#### å“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡è®°å½•è¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "orderId": "ORDER20231201001",
    "type": "income",
    "amount": 7999.00,
    "paymentMethod": "alipay",
    "status": 2,
    "transactionTime": "2023-12-01 09:05:00",
    "remark": "iPhone 14 Proé”€å”®æ¬¾"
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 3. è·å–è´¢åŠ¡è®°å½•åˆ—è¡¨
**GET** `/api/income/list?page=1&pageSize=20&type=income&status=2`

#### æŸ¥è¯¢å‚æ•°
- `page`: é¡µç ï¼ˆé»˜è®¤1ï¼‰
- `pageSize`: æ¯é¡µè®°å½•æ•°ï¼ˆé»˜è®¤20ï¼Œæœ€å¤§100ï¼‰
- `type`: è´¢åŠ¡ç±»å‹ï¼ˆincome/refundï¼‰
- `status`: çŠ¶æ€ï¼ˆ1-å¾…å…¥è´¦ï¼Œ2-å·²å…¥è´¦ï¼‰

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›åˆ†é¡µåˆ—è¡¨
```

#### å“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡è®°å½•åˆ—è¡¨è·å–æˆåŠŸ",
  "data": {
    "incomes": [
      {
        "id": 1,
        "orderId": "ORDER20231201001",
        "type": "income",
        "amount": 7999.00,
        "paymentMethod": "alipay",
        "status": 2,
        "transactionTime": "2023-12-01 09:05:00",
        "remark": "iPhone 14 Proé”€å”®æ¬¾"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalIncome": 150000.00,
    "totalRefund": 5000.00,
    "netIncome": 145000.00
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 4. æ›´æ–°è´¢åŠ¡è®°å½•
**PUT** `/api/income/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æ£€æŸ¥è®°å½•å­˜åœ¨ â†’ æ›´æ–°è®°å½• â†’ è¿”å›æ›´æ–°ç»“æœ
```

#### è¯·æ±‚
```json
{
  "amount": 8500.00,
  "status": 2,
  "remark": "æ›´æ–°åçš„å¤‡æ³¨"
}
```

#### å“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡è®°å½•æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "orderId": "ORDER20231201001",
    "type": "income",
    "amount": 8500.00,
    "paymentMethod": "alipay",
    "status": 2,
    "transactionTime": "2023-12-01 09:05:00",
    "remark": "æ›´æ–°åçš„å¤‡æ³¨"
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 5. åˆ é™¤è´¢åŠ¡è®°å½•
**DELETE** `/api/income/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æ£€æŸ¥è®°å½•å­˜åœ¨ â†’ åˆ é™¤è®°å½• â†’ è¿”å›åˆ é™¤ç»“æœ
```

#### å“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡è®°å½•åˆ é™¤æˆåŠŸ"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 6. æ›´æ–°è´¢åŠ¡çŠ¶æ€
**PUT** `/api/income/{id}/status`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ éªŒè¯çŠ¶æ€å€¼ â†’ æ›´æ–°çŠ¶æ€ â†’ è¿”å›ç»“æœ
```

#### è¯·æ±‚
```json
{
  "status": 2
}
```

#### å“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡çŠ¶æ€æ›´æ–°æˆåŠŸ"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 7. è·å–è´¢åŠ¡ç»Ÿè®¡
**GET** `/api/income/statistics`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ â†’ è¿”å›ç»Ÿè®¡æ•°æ®
```

#### å“åº”
```json
{
  "success": true,
  "message": "è´¢åŠ¡ç»Ÿè®¡è·å–æˆåŠŸ",
  "data": {
    "totalIncome": 150000.00,
    "totalRefund": 5000.00,
    "netIncome": 145000.00
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

---

### 8. æ ¹æ®è®¢å•å·æŸ¥è¯¢è´¢åŠ¡è®°å½•
**GET** `/api/income/order/{orderId}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æŸ¥è¯¢è®¢å•ç›¸å…³è®°å½• â†’ è¿”å›è®°å½•åˆ—è¡¨
```

#### å“åº”
```json
{
  "success": true,
  "message": "è®¢å•è´¢åŠ¡è®°å½•è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "orderId": "ORDER20231201001",
      "type": "income",
      "amount": 7999.00,
      "paymentMethod": "alipay",
      "status": 2,
      "transactionTime": "2023-12-01 09:05:00",
      "remark": "iPhone 14 Proé”€å”®æ¬¾"
    }
  ]
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è´¢åŠ¡ç®¡ç†æƒé™

### ğŸ” æƒé™æ§åˆ¶

æ‰€æœ‰è´¢åŠ¡ç›¸å…³APIå‡ä½¿ç”¨`@RequirePermission`æ³¨è§£è¿›è¡Œæƒé™éªŒè¯ï¼Œéœ€è¦ä»¥ä¸‹ä»»æ„ä¸€ç§æƒé™ï¼š
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- è´¢åŠ¡ç®¡ç†æƒé™ (`Permission.INCOME_MANAGE`)

æƒé™éªŒè¯é€»è¾‘ä¸ºORï¼ˆä»»æ„æ»¡è¶³ä¸€ä¸ªå³å¯ï¼‰ï¼Œé€šè¿‡`RequirePermission.LogicType.OR`é…ç½®ã€‚

### ğŸ“Š æ•°æ®åº“å­—æ®µè¯´æ˜

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | INT | è´¢åŠ¡è®°å½•IDï¼Œä¸»é”® |
| order_id | VARCHAR(50) | å…³è”è®¢å•å· |
| type | VARCHAR(20) | ç±»å‹ï¼šincome-æ”¶å…¥ï¼Œrefund-é€€æ¬¾ |
| amount | DECIMAL(10,2) | é‡‘é¢ï¼ˆæ­£æ•°ä¸ºæ”¶å…¥ï¼Œè´Ÿæ•°ä¸ºé€€æ¬¾ï¼‰ |
| payment_method | VARCHAR(20) | æ”¯ä»˜æ–¹å¼ |
| status | TINYINT | çŠ¶æ€ï¼š1-å¾…å…¥è´¦ï¼Œ2-å·²å…¥è´¦ |
| transaction_time | DATETIME | äº¤æ˜“æ—¶é—´ |
| remark | VARCHAR(200) | å¤‡æ³¨ |


## ğŸ”Œ è¯„ä»·ç®¡ç†APIæ–‡æ¡£ï¼ˆè¯„ä»·ç®¡ç†æ¨¡å—ï¼‰

### 1. åˆ›å»ºè¯„ä»·
**POST** `/api/review`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ éªŒè¯è¯·æ±‚æ•°æ® â†’ åˆ›å»ºè¯„ä»· â†’ è¿”å›ç»“æœ
```

### æƒé™è¦æ±‚
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- è®¢å•ç®¡ç†æƒé™ (`Permission.ORDER_MANAGE`)

### è¯·æ±‚ç¤ºä¾‹
```json
{
  "orderId": "ORDER20231201001",
  "productId": 1,
  "userId": 1001,
  "rating": 5,
  "content": "å•†å“è´¨é‡å¾ˆå¥½ï¼Œç‰©æµå¾ˆå¿«",
  "images": "image1.jpg,image2.jpg",
  "anonymous": false
}
```

### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "è¯„ä»·åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 101,
    "orderId": "ORDER20231201001",
    "productId": 1,
    "userId": 1001,
    "rating": 5,
    "content": "å•†å“è´¨é‡å¾ˆå¥½ï¼Œç‰©æµå¾ˆå¿«",
    "images": "image1.jpg,image2.jpg",
    "anonymous": false,
    "createdAt": "2023-12-01T10:30:00"
  }
}
```

### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "è¯¥è®¢å•å·²è¯„ä»·",
  "errorCode": "REVIEW_EXISTS"
}
```

---

### 2. è·å–è¯„ä»·åˆ—è¡¨
**GET** `/api/review?productId=1&page=1&pageSize=20`

### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›åˆ†é¡µåˆ—è¡¨
```

### æŸ¥è¯¢å‚æ•°
- `productId` (å¯é€‰): å•†å“ID
- `userId` (å¯é€‰): ç”¨æˆ·ID
- `page` (å¯é€‰, é»˜è®¤1): é¡µç 
- `pageSize` (å¯é€‰, é»˜è®¤20, æœ€å¤§100): æ¯é¡µæ•°é‡

### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "reviews": [
      {
        "id": 101,
        "orderId": "ORDER20231201001",
        "productId": 1,
        "userId": 1001,
        "rating": 5,
        "content": "å•†å“è´¨é‡å¾ˆå¥½",
        "images": "image1.jpg",
        "anonymous": false,
        "createdAt": "2023-12-01T10:30:00"
      }
    ],
    "total": 50,
    "page": 1,
    "pageSize": 20
  }
}
```

---

### 3. è·å–è¯„ä»·è¯¦æƒ…
**GET** `/api/review/{id}`

### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "id": 101,
    "orderId": "ORDER20231201001",
    "productId": 1,
    "userId": 1001,
    "rating": 5,
    "content": "å•†å“è´¨é‡å¾ˆå¥½",
    "images": "image1.jpg",
    "anonymous": false,
    "createdAt": "2023-12-01T10:30:00"
  }
}
```

---

### 4. è·å–è¯„ä»·ç»Ÿè®¡
**GET** `/api/review/stats/{productId}`

### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "averageRating": 4.5,
    "totalReviews": 120,
    "distribution": {
      "rating1": 5,
      "rating2": 10,
      "rating3": 15,
      "rating4": 40,
      "rating5": 50
    }
  }
}
```

---

### 5. åˆ é™¤è¯„ä»·
**DELETE** `/api/review/{id}`

### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ",
  "data": null
}
```

---

### ğŸ” æƒé™æ§åˆ¶

æ‰€æœ‰APIå‡ä½¿ç”¨`@RequirePermission`æ³¨è§£è¿›è¡Œæƒé™éªŒè¯ï¼Œéœ€è¦ä»¥ä¸‹ä»»æ„ä¸€ç§æƒé™ï¼š
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- è®¢å•ç®¡ç†æƒé™ (`Permission.ORDER_MANAGE`)

æƒé™éªŒè¯é€»è¾‘ä¸ºORï¼ˆä»»æ„æ»¡è¶³ä¸€ä¸ªå³å¯ï¼‰ï¼Œé€šè¿‡`RequirePermission.LogicType.OR`é…ç½®ã€‚

---

### ğŸ“Š æ•°æ®åº“è¡¨è¯´æ˜

ä½¿ç”¨ç°æœ‰è¡¨ `apexflow_review`ï¼š
```sql
CREATE TABLE apexflow_review (
    id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'è¯„ä»·ID',
    order_id VARCHAR(50) NOT NULL COMMENT 'å…³è”è®¢å•å·',
    product_id INT NOT NULL COMMENT 'å•†å“ID',
    user_id INT NOT NULL COMMENT 'è¯„ä»·ç”¨æˆ·ID',
    rating TINYINT NOT NULL COMMENT 'è¯„åˆ†ï¼š1-5æ˜Ÿ',
    content TEXT COMMENT 'è¯„ä»·å†…å®¹',
    images TEXT COMMENT 'è¯„ä»·å›¾ç‰‡URLï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”',
    is_anonymous BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦åŒ¿åè¯„ä»·',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'è¯„ä»·æ—¶é—´'
) COMMENT='å•†å“è¯„ä»·è¡¨';
```

## ğŸ”Œ APIæ¥å£æ–‡æ¡£ï¼ˆè®¢å•ç®¡ç†æ¨¡å—ï¼‰

### 1. åˆ›å»ºè®¢å•
**POST** `/api/orders`

#### æµç¨‹
```
å®¢æˆ·ç«¯ (HTTPS) â†’ éªŒè¯Token â†’ éªŒè¯è¾“å…¥æ•°æ® â†’ åˆ›å»ºè®¢å•ä¸»ä¿¡æ¯å’Œè®¢å•é¡¹ â†’ è¿”å›åˆ›å»ºç»“æœ
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
Content-Type: application/json
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "userId": 1001,
  "totalAmount": 7999.00,
  "paymentMethod": "alipay",
  "addressId": 123,
  "orderItems": [
    {
      "productId": 1,
      "productName": "iPhone 14 Pro",
      "quantity": 1,
      "price": 7999.00,
      "subtotal": 7999.00
    }
  ]
}
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "è®¢å•åˆ›å»ºæˆåŠŸ",
  "data": {
    "orderId": "ORDER1701234567890",
    "totalAmount": 7999.00,
    "status": 1,
    "createdAt": "2023-12-01T09:00:00"
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "ç”¨æˆ·IDã€æ€»é‡‘é¢å’Œè®¢å•é¡¹ä¸èƒ½ä¸ºç©º"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è®¢å•ç®¡ç†æƒé™

---

### 2. è·å–è®¢å•è¯¦æƒ…
**GET** `/api/orders/{orderId}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›è®¢å•è¯¦æƒ…
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è®¢å•è¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "orderId": "ORDER20231201001",
    "userId": 1001,
    "totalAmount": 7999.00,
    "status": 4,
    "paymentMethod": "alipay",
    "addressId": 123,
    "createdAt": "2023-12-01T09:00:00",
    "paidAt": "2023-12-01T09:05:00",
    "shippedAt": "2023-12-01T14:00:00",
    "completedAt": "2023-12-03T10:00:00",
    "orderItems": [
      {
        "id": 1,
        "orderId": "ORDER20231201001",
        "productId": 1,
        "productName": "iPhone 14 Pro",
        "quantity": 1,
        "price": 7999.00,
        "subtotal": 7999.00
      }
    ]
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è®¢å•ç®¡ç†æƒé™

---

### 3. è·å–è®¢å•åˆ—è¡¨
**GET** `/api/orders/list?page=1&pageSize=20&userId=1001&status=4`

#### æŸ¥è¯¢å‚æ•°
- `page`: é¡µç ï¼ˆé»˜è®¤1ï¼‰
- `pageSize`: æ¯é¡µè®°å½•æ•°ï¼ˆé»˜è®¤20ï¼Œæœ€å¤§100ï¼‰
- `userId`: ç”¨æˆ·IDï¼ˆå¯é€‰ï¼‰
- `status`: è®¢å•çŠ¶æ€ï¼ˆå¯é€‰ï¼Œ1-å¾…æ”¯ä»˜ï¼Œ2-å·²æ”¯ä»˜ï¼Œ3-å·²å‘è´§ï¼Œ4-å·²å®Œæˆï¼Œ5-å·²å–æ¶ˆï¼‰

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›åˆ†é¡µåˆ—è¡¨
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è®¢å•åˆ—è¡¨è·å–æˆåŠŸ",
  "data": {
    "orders": [
      {
        "orderId": "ORDER20231201001",
        "userId": 1001,
        "totalAmount": 7999.00,
        "status": 4,
        "paymentMethod": "alipay",
        "createdAt": "2023-12-01T09:00:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 50,
    "totalPages": 3
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è®¢å•ç®¡ç†æƒé™

---

### 4. æ›´æ–°è®¢å•ä¿¡æ¯
**PUT** `/api/orders/{orderId}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æ£€æŸ¥è®¢å•å­˜åœ¨ â†’ æ›´æ–°è®¢å•ä¿¡æ¯ â†’ è¿”å›æ›´æ–°ç»“æœ
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "addressId": 124,
  "paymentMethod": "wxpay"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è®¢å•ä¿¡æ¯æ›´æ–°æˆåŠŸ"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è®¢å•ç®¡ç†æƒé™

---

### 5. åˆ é™¤è®¢å•
**DELETE** `/api/orders/{orderId}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ æ£€æŸ¥è®¢å•å­˜åœ¨ â†’ çº§è”åˆ é™¤è®¢å•åŠç›¸å…³è®°å½• â†’ è¿”å›åˆ é™¤ç»“æœ
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è®¢å•åˆ é™¤æˆåŠŸ"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è®¢å•ç®¡ç†æƒé™

---

### 6. æ›´æ–°è®¢å•çŠ¶æ€
**PUT** `/api/orders/{orderId}/status`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Token â†’ éªŒè¯çŠ¶æ€å€¼ â†’ æ›´æ–°çŠ¶æ€ â†’ è¿”å›ç»“æœ
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "status": 2
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è®¢å•çŠ¶æ€æ›´æ–°æˆåŠŸ"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æˆ–è®¢å•ç®¡ç†æƒé™

### ğŸ“Š è®¢å•çŠ¶æ€è¯´æ˜
| çŠ¶æ€ç  | çŠ¶æ€è¯´æ˜ | å…è®¸çš„æ“ä½œ |
|--------|----------|------------|
| 1 | å¾…æ”¯ä»˜ | æ›´æ–°è®¢å•ä¿¡æ¯ã€åˆ é™¤è®¢å•ã€æ›´æ–°çŠ¶æ€ä¸º2æˆ–5 |
| 2 | å·²æ”¯ä»˜ | æ›´æ–°è®¢å•ä¿¡æ¯ã€åˆ é™¤è®¢å•ã€æ›´æ–°çŠ¶æ€ä¸º3æˆ–5 |
| 3 | å·²å‘è´§ | æ›´æ–°çŠ¶æ€ä¸º4 |
| 4 | å·²å®Œæˆ | æ— çŠ¶æ€æ›´æ–°æ“ä½œ |
| 5 | å·²å–æ¶ˆ | æ— çŠ¶æ€æ›´æ–°æ“ä½œ |

### ğŸ” æƒé™æ§åˆ¶
æ‰€æœ‰è®¢å•ç›¸å…³APIå‡ä½¿ç”¨`@RequirePermission`æ³¨è§£è¿›è¡Œæƒé™éªŒè¯ï¼Œéœ€è¦ä»¥ä¸‹ä»»æ„ä¸€ç§æƒé™ï¼š
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- è®¢å•ç®¡ç†æƒé™ (`Permission.ORDER_MANAGE`)

æƒé™éªŒè¯é€»è¾‘ä¸ºORï¼ˆä»»æ„æ»¡è¶³ä¸€ä¸ªå³å¯ï¼‰ï¼Œé€šè¿‡`RequirePermission.LogicType.OR`é…ç½®ã€‚

---

## ğŸ”Œ !!!! *ç®¡ç†å‘˜ç®¡ç†æ¨¡å— API æ–‡æ¡£*ï¼ˆç³»ç»Ÿè®¾ç½®æ¨¡å—ï¼‰

### 1. è·å–ç”¨æˆ·åˆ—è¡¨
**GET** `/api/admin/users`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Token â†’ TokenéªŒè¯ â†’ ç®¡ç†å‘˜æƒé™éªŒè¯ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›åˆ†é¡µç”¨æˆ·åˆ—è¡¨
```

#### æŸ¥è¯¢å‚æ•°
- `page` (å¯é€‰, é»˜è®¤1): é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
- `pageSize` (å¯é€‰, é»˜è®¤20, æœ€å¤§100): æ¯é¡µè®°å½•æ•°

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "è·å–ç”¨æˆ·åˆ—è¡¨æˆåŠŸ",
  "data": {
    "users": [
      {
        "id": 1,
        "username": "admin",
        "realName": "ç³»ç»Ÿç®¡ç†å‘˜",
        "email": "admin@apexflow.com",
        "phone": "13800138000",
        "isAdmin": true,
        "canManageOrder": true,
        "canManageLogistics": true,
        "canManageAfterSales": true,
        "canManageReview": true,
        "canManageInventory": true,
        "canManageIncome": true,
        "status": 1,
        "createdAt": "2023-12-01T09:00:00",
        "updatedAt": "2023-12-01T09:00:00",
        "lastLoginAt": "2023-12-01T10:30:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 50,
    "totalPages": 3
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "éœ€è¦ç®¡ç†å‘˜æƒé™"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)

---

### 2. æœç´¢ç”¨æˆ·
**GET** `/api/admin/users/search`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Token â†’ TokenéªŒè¯ â†’ ç®¡ç†å‘˜æƒé™éªŒè¯ â†’ æ¨¡ç³Šæœç´¢æ•°æ®åº“ â†’ è¿”å›æœç´¢ç»“æœ
```

#### æŸ¥è¯¢å‚æ•°
- `keyword` (å¿…éœ€): æœç´¢å…³é”®è¯ï¼ˆç”¨æˆ·åã€çœŸå®å§“åã€é‚®ç®±ã€ç”µè¯ï¼‰
- `page` (å¯é€‰, é»˜è®¤1): é¡µç 
- `pageSize` (å¯é€‰, é»˜è®¤20): æ¯é¡µè®°å½•æ•°

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æœç´¢ç”¨æˆ·æˆåŠŸ",
  "data": {
    "users": [
      {
        "id": 2,
        "username": "user1",
        "realName": "å¼ ä¸‰",
        "email": "zhangsan@example.com",
        "phone": "13800138001",
        "isAdmin": false,
        "canManageOrder": true,
        "canManageLogistics": false,
        "canManageAfterSales": false,
        "canManageReview": false,
        "canManageInventory": false,
        "canManageIncome": false,
        "status": 1,
        "createdAt": "2023-12-01T09:00:00",
        "updatedAt": "2023-12-01T09:00:00",
        "lastLoginAt": "2023-12-01T10:30:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 1,
    "totalPages": 1
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)

---

### 3. æ›´æ–°ç”¨æˆ·ä¿¡æ¯
**PUT** `/api/admin/users/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Tokenå’Œæ›´æ–°æ•°æ® â†’ TokenéªŒè¯ â†’ ç®¡ç†å‘˜æƒé™éªŒè¯ â†’ éªŒè¯è¾“å…¥æ•°æ® â†’ æ›´æ–°æ•°æ®åº“
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
Content-Type: application/json
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "realName": "æå››",
  "email": "lisi@example.com",
  "phone": "13800138002",
  "status": 1
}
```

*è‡³å°‘æä¾›ä¸€ä¸ªå­—æ®µ*

### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æ›´æ–°ç”¨æˆ·ä¿¡æ¯æˆåŠŸ",
  "data": {
    "id": 2,
    "username": "user1",
    "realName": "æå››",
    "email": "lisi@example.com",
    "phone": "13800138002",
    "isAdmin": false,
    "canManageOrder": true,
    "canManageLogistics": false,
    "canManageAfterSales": false,
    "canManageReview": false,
    "canManageInventory": false,
    "canManageIncome": false,
    "status": 1,
    "createdAt": "2023-12-01T09:00:00",
    "updatedAt": "2023-12-02T10:30:00",
    "lastLoginAt": "2023-12-01T10:30:00"
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "é‚®ç®±å·²è¢«å…¶ä»–ç”¨æˆ·ä½¿ç”¨"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)

---

### 4. æ›´æ–°ç”¨æˆ·æƒé™
**PUT** `/api/admin/users/{id}/permissions`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Tokenå’Œæƒé™æ•°æ® â†’ TokenéªŒè¯ â†’ ç®¡ç†å‘˜æƒé™éªŒè¯ â†’ æ›´æ–°æƒé™å­—æ®µ â†’ è¿”å›æ›´æ–°ç»“æœ
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
Content-Type: application/json
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "isAdmin": false,
  "canManageOrder": true,
  "canManageLogistics": true,
  "canManageAfterSales": false,
  "canManageReview": false,
  "canManageInventory": true,
  "canManageIncome": false
}
```

*è‡³å°‘æä¾›ä¸€ä¸ªæƒé™å­—æ®µ*

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æ›´æ–°ç”¨æˆ·æƒé™æˆåŠŸ",
  "data": {
    "userId": 2,
    "isAdmin": false,
    "canManageOrder": true,
    "canManageLogistics": true,
    "canManageAfterSales": false,
    "canManageReview": false,
    "canManageInventory": true,
    "canManageIncome": false
  }
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)

---

### 5. é‡ç½®ç”¨æˆ·å¯†ç 
**PUT** `/api/admin/users/{id}/password`

#### æµç¨‹
```
å®¢æˆ·ç«¯å¸¦Tokenå’Œæ–°å¯†ç  â†’ TokenéªŒè¯ â†’ ç®¡ç†å‘˜æƒé™éªŒè¯ â†’ å¯†ç å¼ºåº¦éªŒè¯ â†’ ç”Ÿæˆæ–°ç›å“ˆå¸Œ â†’ æ›´æ–°æ•°æ®åº“
```

#### è¯·æ±‚å¤´
```
Authorization: Bearer jwt_token_here
Content-Type: application/json
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "newPassword": "newpassword123"
}
```

*å¯†ç é•¿åº¦è‡³å°‘6ä½*

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "é‡ç½®å¯†ç æˆåŠŸ",
  "data": {
    "success": true,
    "message": "å¯†ç é‡ç½®æˆåŠŸ",
    "userId": 2
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½"
}
```

**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)

---

### ğŸ“Š ç”¨æˆ·çŠ¶æ€è¯´æ˜
| çŠ¶æ€ç  | çŠ¶æ€è¯´æ˜ |
|--------|----------|
| 1 | æ­£å¸¸ |
| 0 | ç¦ç”¨ |

### ğŸ” æƒé™æ§åˆ¶
æ‰€æœ‰ç®¡ç†å‘˜APIå‡ä½¿ç”¨`@RequirePermission`æ³¨è§£è¿›è¡Œæƒé™éªŒè¯ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™ï¼š
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)

æƒé™éªŒè¯é€»è¾‘ä¸ºORï¼ˆä»»æ„æ»¡è¶³ä¸€ä¸ªå³å¯ï¼‰ï¼Œé€šè¿‡`RequirePermission.LogicType.OR`é…ç½®ã€‚

---



## ğŸ”Œ å”®åæœåŠ¡APIæ–‡æ¡£ï¼ˆå”®åç®¡ç†æ¨¡å—ï¼‰

### 1. åˆ›å»ºå”®åç”³è¯·
**POST** `/api/after-sales`

#### æµç¨‹
```
å®¢æˆ·ç«¯ (HTTPS) â†’ éªŒè¯Tokenå’Œæƒé™ â†’ éªŒè¯è¯·æ±‚æ•°æ® â†’ åˆ›å»ºå”®åè®°å½• â†’ è¿”å›åˆ›å»ºç»“æœ
```

#### æƒé™è¦æ±‚
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- å”®åç®¡ç†æƒé™ (`Permission.AFTER_SALES_MANAGE`)

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "orderId": "ORDER20231201001",
  "type": 1,
  "reason": "å•†å“è´¨é‡é—®é¢˜",
  "refundAmount": 7999.00
}
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "å”®åç”³è¯·åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 101,
    "orderId": "ORDER20231201001",
    "type": 1,
    "reason": "å•†å“è´¨é‡é—®é¢˜",
    "status": 1,
    "refundAmount": 7999.00,
    "applyTime": "2023-12-01T10:30:00",
    "processTime": null,
    "processRemark": null
  }
}
```

---

### 2. è·å–å”®åè¯¦æƒ…
**GET** `/api/after-sales/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›å”®åè¯¦æƒ…
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–å”®åè¯¦æƒ…æˆåŠŸ",
  "data": {
    "id": 101,
    "orderId": "ORDER20231201001",
    "type": 1,
    "reason": "å•†å“è´¨é‡é—®é¢˜",
    "status": 1,
    "refundAmount": 7999.00,
    "applyTime": "2023-12-01T10:30:00",
    "processTime": null,
    "processRemark": null
  }
}
```

---

### 3. è·å–å”®ååˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
**GET** `/api/after-sales?page=1&pageSize=20`

#### æŸ¥è¯¢å‚æ•°
- `page` (å¯é€‰, é»˜è®¤1): é¡µç 
- `pageSize` (å¯é€‰, é»˜è®¤20, æœ€å¤§100): æ¯é¡µå¤§å°

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–å”®ååˆ—è¡¨æˆåŠŸ",
  "data": {
    "data": [
      {
        "id": 101,
        "orderId": "ORDER20231201001",
        "type": 1,
        "reason": "å•†å“è´¨é‡é—®é¢˜",
        "status": 1,
        "refundAmount": 7999.00,
        "applyTime": "2023-12-01T10:30:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 50
  }
}
```

---

### 4. è·å–è®¢å•å”®åè®°å½•
**GET** `/api/after-sales/order/{orderId}`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–è®¢å•å”®åè®°å½•æˆåŠŸ",
  "data": [
    {
      "id": 101,
      "orderId": "ORDER20231201001",
      "type": 1,
      "reason": "å•†å“è´¨é‡é—®é¢˜",
      "status": 1,
      "refundAmount": 7999.00,
      "applyTime": "2023-12-01T10:30:00"
    }
  ]
}
```

---

### 5. æ ¹æ®çŠ¶æ€è·å–å”®ååˆ—è¡¨
**GET** `/api/after-sales/status/{status}?page=1&pageSize=20`

#### çŠ¶æ€è¯´æ˜
- 1: ç”³è¯·ä¸­
- 2: å®¡æ ¸é€šè¿‡
- 3: å®¡æ ¸æ‹’ç»
- 4: å·²å®Œæˆ

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–çŠ¶æ€å”®ååˆ—è¡¨æˆåŠŸ",
  "data": {
    "data": [
      {
        "id": 101,
        "orderId": "ORDER20231201001",
        "type": 1,
        "reason": "å•†å“è´¨é‡é—®é¢˜",
        "status": 1,
        "refundAmount": 7999.00,
        "applyTime": "2023-12-01T10:30:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 15
  }
}
```

---

### 6. æ›´æ–°å”®åçŠ¶æ€
**PUT** `/api/after-sales/{id}/status`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "status": 2,
  "remark": "å®¡æ ¸é€šè¿‡ï¼ŒåŒæ„é€€æ¬¾"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æ›´æ–°å”®åçŠ¶æ€æˆåŠŸ",
  "data": {
    "id": 101,
    "orderId": "ORDER20231201001",
    "type": 1,
    "reason": "å•†å“è´¨é‡é—®é¢˜",
    "status": 2,
    "refundAmount": 7999.00,
    "applyTime": "2023-12-01T10:30:00",
    "processTime": "2023-12-01T14:00:00",
    "processRemark": "å®¡æ ¸é€šè¿‡ï¼ŒåŒæ„é€€æ¬¾"
  }
}
```

---

### 7. åˆ é™¤å”®åè®°å½•
**DELETE** `/api/after-sales/{id}`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åˆ é™¤å”®åè®°å½•æˆåŠŸ",
  "data": null
}
```

---

### 8. è·å–å”®åç»Ÿè®¡
**GET** `/api/after-sales/stats`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–å”®åç»Ÿè®¡æˆåŠŸ",
  "data": {
    "totalCount": 50
  }
}
```
---

## ğŸ”Œ APIæ¥å£æ–‡æ¡£ï¼ˆç‰©æµç®¡ç†æ¨¡å—ï¼‰

### 1. åˆ›å»ºç‰©æµä¿¡æ¯
**POST** `/api/logistics`

#### æµç¨‹
```
å®¢æˆ·ç«¯ (HTTPS) â†’ éªŒè¯Tokenå’Œæƒé™ â†’ éªŒè¯è¯·æ±‚æ•°æ® â†’ åˆ›å»ºç‰©æµè®°å½• â†’ è¿”å›åˆ›å»ºç»“æœ
```

#### æƒé™è¦æ±‚
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- ç‰©æµç®¡ç†æƒé™ (`Permission.LOGISTICS_MANAGE`)

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "orderId": "ORDER20231201051",
  "expressCompany": "é¡ºä¸°é€Ÿè¿",
  "trackingNumber": "SF202312015001",
  "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº",
  "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒº"
}
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "ç‰©æµä¿¡æ¯åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 51,
    "orderId": "ORDER20231201051",
    "expressCompany": "é¡ºä¸°é€Ÿè¿",
    "trackingNumber": "SF202312015001",
    "status": "pending",
    "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº",
    "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒº",
    "shippedAt": null,
    "deliveredAt": null,
    "createdAt": "2023-12-01T10:30:00"
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "è¯¥è®¢å•å·²æœ‰ç‰©æµè®°å½•",
  "errorCode": "LOGISTICS_EXISTS"
}
```

---

### 2. æ ¹æ®IDè·å–ç‰©æµè¯¦æƒ…
**GET** `/api/logistics/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›ç‰©æµè¯¦æƒ…
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–ç‰©æµè¯¦æƒ…æˆåŠŸ",
  "data": {
    "id": 1,
    "orderId": "ORDER20231201001",
    "expressCompany": "é¡ºä¸°é€Ÿè¿",
    "trackingNumber": "SF12345678901",
    "status": "delivered",
    "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº",
    "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒº",
    "shippedAt": "2023-12-01T14:00:00",
    "deliveredAt": "2023-12-03T10:00:00",
    "createdAt": "2023-12-01T14:00:00"
  }
}
```

---

### 3. æ ¹æ®è®¢å•å·è·å–ç‰©æµä¿¡æ¯
**GET** `/api/logistics/order/{orderId}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›ç‰©æµä¿¡æ¯
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–è®¢å•ç‰©æµä¿¡æ¯æˆåŠŸ",
  "data": {
    "id": 1,
    "orderId": "ORDER20231201001",
    "expressCompany": "é¡ºä¸°é€Ÿè¿",
    "trackingNumber": "SF12345678901",
    "status": "delivered",
    "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº",
    "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒº",
    "shippedAt": "2023-12-01T14:00:00",
    "deliveredAt": "2023-12-03T10:00:00",
    "createdAt": "2023-12-01T14:00:00"
  }
}
```

---

### 4. è·å–ç‰©æµåˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
**GET** `/api/logistics?page=1&pageSize=20`

#### æŸ¥è¯¢å‚æ•°
- `page` (å¯é€‰, é»˜è®¤1): é¡µç 
- `pageSize` (å¯é€‰, é»˜è®¤20, æœ€å¤§100): æ¯é¡µå¤§å°

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–ç‰©æµåˆ—è¡¨æˆåŠŸ",
  "data": {
    "data": [
      {
        "id": 1,
        "orderId": "ORDER20231201001",
        "expressCompany": "é¡ºä¸°é€Ÿè¿",
        "trackingNumber": "SF12345678901",
        "status": "delivered",
        "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº",
        "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒº",
        "shippedAt": "2023-12-01T14:00:00",
        "deliveredAt": "2023-12-03T10:00:00",
        "createdAt": "2023-12-01T14:00:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 50,
    "totalPages": 3
  }
}
```

---

### 5. è·å–å¾…å‘è´§åˆ—è¡¨
**GET** `/api/logistics/pending?page=1&pageSize=20`

#### æŸ¥è¯¢å‚æ•°
- `page` (å¯é€‰, é»˜è®¤1): é¡µç 
- `pageSize` (å¯é€‰, é»˜è®¤20): æ¯é¡µå¤§å°

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–å¾…å‘è´§åˆ—è¡¨æˆåŠŸ",
  "data": {
    "data": [
      {
        "id": 5,
        "orderId": "ORDER20231201005",
        "expressCompany": null,
        "trackingNumber": null,
        "status": "pending",
        "senderAddress": null,
        "receiverAddress": null,
        "shippedAt": null,
        "deliveredAt": null,
        "createdAt": "2023-12-01T11:00:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 10,
    "totalPages": 1
  }
}
```

---

### 6. è·å–è¿è¾“ä¸­åˆ—è¡¨
**GET** `/api/logistics/in-transit?page=1&pageSize=20`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–è¿è¾“ä¸­åˆ—è¡¨æˆåŠŸ",
  "data": {
    "data": [
      {
        "id": 3,
        "orderId": "ORDER20231201003",
        "expressCompany": "åœ†é€šé€Ÿé€’",
        "trackingNumber": "YT12345678901",
        "status": "shipped",
        "senderAddress": "å¹¿å·å¸‚å¤©æ²³åŒº",
        "receiverAddress": "æ·±åœ³å¸‚å—å±±åŒº",
        "shippedAt": "2023-12-02T10:00:00",
        "deliveredAt": null,
        "createdAt": "2023-12-02T10:00:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 5,
    "totalPages": 1
  }
}
```

---

### 7. æ›´æ–°ç‰©æµä¿¡æ¯
**PUT** `/api/logistics/{id}`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "orderId": "ORDER20231201001",
  "expressCompany": "äº¬ä¸œç‰©æµ",
  "trackingNumber": "JD12345678999",
  "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºæ–°åœ°å€",
  "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒºæ–°åœ°å€"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æ›´æ–°ç‰©æµä¿¡æ¯æˆåŠŸ",
  "data": {
    "id": 1,
    "orderId": "ORDER20231201001",
    "expressCompany": "äº¬ä¸œç‰©æµ",
    "trackingNumber": "JD12345678999",
    "status": "delivered",
    "senderAddress": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºæ–°åœ°å€",
    "receiverAddress": "åŒ—äº¬å¸‚æœé˜³åŒºæ–°åœ°å€",
    "shippedAt": "2023-12-01T14:00:00",
    "deliveredAt": "2023-12-03T10:00:00",
    "createdAt": "2023-12-01T14:00:00"
  }
}
```

---

### 8. æ›´æ–°ç‰©æµçŠ¶æ€
**PUT** `/api/logistics/{id}/status`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "status": "shipped"
}
```

#### çŠ¶æ€è¯´æ˜
- `pending`: å¾…å‘è´§
- `shipped`: å·²å‘è´§
- `delivered`: å·²é€è¾¾

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æ›´æ–°ç‰©æµçŠ¶æ€æˆåŠŸ",
  "data": {
    "id": 5,
    "orderId": "ORDER20231201005",
    "expressCompany": null,
    "trackingNumber": null,
    "status": "shipped",
    "senderAddress": null,
    "receiverAddress": null,
    "shippedAt": "2023-12-02T14:00:00",
    "deliveredAt": null,
    "createdAt": "2023-12-01T11:00:00"
  }
}
```

---

### 9. æ›´æ–°å‘è´§ä¿¡æ¯
**PUT** `/api/logistics/{id}/shipping`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "expressCompany": "ä¸­é€šå¿«é€’",
  "trackingNumber": "ZT987654321",
  "senderAddress": "ä¸Šæµ·å¸‚å¾æ±‡åŒº"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "æ›´æ–°å‘è´§ä¿¡æ¯æˆåŠŸ",
  "data": {
    "id": 5,
    "orderId": "ORDER20231201005",
    "expressCompany": "ä¸­é€šå¿«é€’",
    "trackingNumber": "ZT987654321",
    "status": "shipped",
    "senderAddress": "ä¸Šæµ·å¸‚å¾æ±‡åŒº",
    "receiverAddress": null,
    "shippedAt": "2023-12-02T14:00:00",
    "deliveredAt": null,
    "createdAt": "2023-12-01T11:00:00"
  }
}
```

---

### 10. åˆ é™¤ç‰©æµè®°å½•
**DELETE** `/api/logistics/{id}`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åˆ é™¤ç‰©æµè®°å½•æˆåŠŸ",
  "data": null
}
```

---

### 11. è·å–ç‰©æµç»Ÿè®¡
**GET** `/api/logistics/stats`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "è·å–ç‰©æµç»Ÿè®¡æˆåŠŸ",
  "data": {
    "pendingCount": 10,
    "shippedCount": 5,
    "deliveredCount": 35
  }
}
```

---

### ğŸ” æƒé™æ§åˆ¶

æ‰€æœ‰ç‰©æµç›¸å…³APIå‡ä½¿ç”¨`@RequirePermission`æ³¨è§£è¿›è¡Œæƒé™éªŒè¯ï¼Œéœ€è¦ä»¥ä¸‹ä»»æ„ä¸€ç§æƒé™ï¼š
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- ç‰©æµç®¡ç†æƒé™ (`Permission.LOGISTICS_MANAGE`)

æƒé™éªŒè¯é€»è¾‘ä¸ºORï¼ˆä»»æ„æ»¡è¶³ä¸€ä¸ªå³å¯ï¼‰ï¼Œé€šè¿‡`RequirePermission.LogicType.OR`é…ç½®ã€‚

---

### ğŸ“Š æ•°æ®åº“å­—æ®µè¯´æ˜

ä½¿ç”¨ç°æœ‰è¡¨ `apexflow_logistics`ï¼š
```sql
CREATE TABLE apexflow_logistics (
    id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç‰©æµID',
    order_id VARCHAR(50) NOT NULL UNIQUE COMMENT 'å…³è”è®¢å•å·ï¼Œä¸€ä¸ªè®¢å•ä¸€ä¸ªç‰©æµ',
    express_company VARCHAR(50) COMMENT 'å¿«é€’å…¬å¸',
    tracking_number VARCHAR(100) COMMENT 'è¿å•å·',
    status VARCHAR(20) DEFAULT 'pending' COMMENT 'çŠ¶æ€ï¼špending-å¾…å‘è´§ï¼Œshipped-å·²å‘è´§ï¼Œdelivered-å·²é€è¾¾',
    sender_address VARCHAR(200) COMMENT 'å‘è´§åœ°å€',
    receiver_address VARCHAR(200) COMMENT 'æ”¶è´§åœ°å€',
    shipped_at DATETIME COMMENT 'å‘è´§æ—¶é—´',
    delivered_at DATETIME COMMENT 'é€è¾¾æ—¶é—´',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´'
) COMMENT='ç‰©æµä¿¡æ¯è¡¨';
```
---

## ğŸ”Œ APIæ¥å£æ–‡æ¡£ï¼ˆåº“å­˜ç®¡ç†æ¨¡å—ï¼‰

### 1. åˆ›å»ºå•†å“
**POST** `/api/inventory/products`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ éªŒè¯è¯·æ±‚æ•°æ® â†’ åˆ›å»ºå•†å“è®°å½• â†’ è¿”å›åˆ›å»ºç»“æœ
```

#### æƒé™è¦æ±‚
- ç®¡ç†å‘˜æƒé™ (`Permission.ADMIN`)
- åº“å­˜ç®¡ç†æƒé™ (`Permission.INVENTORY_MANAGE`)

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "name": "å°ç±³14 Pro",
  "category": "æ‰‹æœº",
  "price": 4999.00,
  "stock": 100,
  "status": 1,
  "image": "xiaomi14.jpg"
}
```

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "å•†å“åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 51,
    "name": "å°ç±³14 Pro",
    "category": "æ‰‹æœº",
    "price": 4999.00,
    "stock": 100,
    "status": 1,
    "image": "xiaomi14.jpg",
    "createdAt": "2023-12-01T10:30:00"
  }
}
```

#### å¤±è´¥å“åº”
```json
{
  "success": false,
  "message": "å•†å“åç§°å’Œä»·æ ¼ä¸èƒ½ä¸ºç©º",
  "errorCode": "INVALID_REQUEST"
}
```

---

### 2. è·å–å•†å“è¯¦æƒ…
**GET** `/api/inventory/products/{id}`

#### æµç¨‹
```
å®¢æˆ·ç«¯ â†’ éªŒè¯Tokenå’Œæƒé™ â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›å•†å“è¯¦æƒ…
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "å•†å“è¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "iPhone 14 Pro",
    "category": "æ‰‹æœº",
    "price": 7999.00,
    "stock": 95,
    "status": 1,
    "image": "iphone14.jpg",
    "createdAt": "2023-12-01T10:00:00"
  }
}
```

---

### 3. è·å–å•†å“åˆ—è¡¨
**GET** `/api/inventory/products/list`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| category | string | å¦ | å•†å“åˆ†ç±»ç­›é€‰ |
| keyword | string | å¦ | å•†å“åç§°æœç´¢ |
| status | integer | å¦ | å•†å“çŠ¶æ€ (1-ä¸Šæ¶, 0-ä¸‹æ¶) |
| page | integer | å¦ | é¡µç ï¼Œé»˜è®¤1 |
| pageSize | integer | å¦ | æ¯é¡µå¤§å°ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100 |

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "å•†å“åˆ—è¡¨è·å–æˆåŠŸ",
  "data": {
    "products": [
      {
        "id": 1,
        "name": "iPhone 14 Pro",
        "category": "æ‰‹æœº",
        "price": 7999.00,
        "stock": 95,
        "status": 1,
        "image": "iphone14.jpg",
        "createdAt": "2023-12-01T10:00:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 50,
    "totalPages": 3
  }
}
```

---

### 4. æ›´æ–°å•†å“ä¿¡æ¯
**PUT** `/api/inventory/products/{id}`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "name": "iPhone 14 Pro Max",
  "price": 8999.00,
  "stock": 120
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "å•†å“ä¿¡æ¯æ›´æ–°æˆåŠŸ",
  "data": null
}
```

---

### 5. åˆ é™¤å•†å“ï¼ˆä¸‹æ¶ï¼‰
**DELETE** `/api/inventory/products/{id}`

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "å•†å“å·²ä¸‹æ¶",
  "data": null
}
```

---

### 6. è°ƒæ•´åº“å­˜
**PUT** `/api/inventory/products/{id}/stock`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "newStock": 150,
  "reason": "ç›˜ç‚¹è°ƒæ•´"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åº“å­˜è°ƒæ•´æˆåŠŸ",
  "data": null
}
```

---

### 7. å¢åŠ åº“å­˜ï¼ˆé‡‡è´­å…¥åº“ï¼‰
**POST** `/api/inventory/stock/increase`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "productId": 1,
  "quantity": 50,
  "orderId": "PUR20231201001"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åº“å­˜å¢åŠ æˆåŠŸ",
  "data": null
}
```

---

### 8. å‡å°‘åº“å­˜ï¼ˆé”€å”®å‡ºåº“ï¼‰
**POST** `/api/inventory/stock/decrease`

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "productId": 1,
  "quantity": 2,
  "orderId": "ORDER20231201051"
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åº“å­˜å‡å°‘æˆåŠŸ",
  "data": null
}
```

---

### 9. è·å–åº“å­˜å˜æ›´æ—¥å¿—
**GET** `/api/inventory/logs`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| productId | integer | å¦ | å•†å“IDç­›é€‰ |
| changeType | string | å¦ | å˜æ›´ç±»å‹ (purchase/sale/adjust) |
| page | integer | å¦ | é¡µç ï¼Œé»˜è®¤1 |
| pageSize | integer | å¦ | æ¯é¡µå¤§å°ï¼Œé»˜è®¤20 |

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "åº“å­˜å˜æ›´æ—¥å¿—è·å–æˆåŠŸ",
  "data": {
    "logs": [
      {
        "id": 1,
        "productId": 1,
        "changeType": "sale",
        "quantity": -1,
        "beforeStock": 100,
        "afterStock": 99,
        "orderId": "ORDER20231201001",
        "createdAt": "2023-12-01T14:00:00"
      }
    ],
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 50
  }
}
```

---

### 10. è·å–ä½åº“å­˜é¢„è­¦
**GET** `/api/inventory/low-stock`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| threshold | integer | å¦ | é¢„è­¦é˜ˆå€¼ï¼Œé»˜è®¤10 |

#### å“åº”ç¤ºä¾‹
```json
{
  "success": true,
  "message": "ä½åº“å­˜é¢„è­¦è·å–æˆåŠŸ",
  "data": {
    "threshold": 10,
    "lowStockProducts": [
      {
        "id": 24,
        "name": "æµ·è“ä¹‹è°œç²¾å",
        "category": "ç¾å¦†",
        "price": 2999.00,
        "stock": 5,
        "status": 1,
        "image": "lamer.jpg",
        "createdAt": "2023-12-01T10:00:00"
      }
    ],
    "count": 3
  }
}
```
---

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. å¯†ç éªŒè¯ï¼ˆä½¿ç”¨ç°æœ‰æ•°æ®åº“ç»“æ„ï¼‰
```java
public class SecurityUtil {
    
    /**
     * éªŒè¯å¯†ç ï¼ˆä¸æ•°æ®åº“å­˜å‚¨æ–¹å¼ä¸€è‡´ï¼‰
     * æ•°æ®åº“ï¼špassword_hash = hash(password + salt)
     */
    public static boolean verifyPassword(String inputPassword, String storedHash, String salt) {
        String inputHash = hashPassword(inputPassword, salt);
        return inputHash.equals(storedHash);
    }
    
    private static String hashPassword(String password, String salt) {
        // ä¸åˆ›å»ºç”¨æˆ·æ—¶çš„å“ˆå¸Œç®—æ³•ä¿æŒä¸€è‡´
        // ç°æœ‰æ•°æ®åº“ç¤ºä¾‹ï¼šsaltæ˜¯32ä½å­—ç¬¦ä¸²ï¼Œå“ˆå¸Œç®—æ³•å¯èƒ½æ˜¯SHA-256
        try {
            MessageDigest md = MessageDigest.getInstance("SHA-256");
            String saltedPassword = password + salt;
            byte[] hash = md.digest(saltedPassword.getBytes());
            return Base64.getEncoder().encodeToString(hash);
        } catch (Exception e) {
            throw new RuntimeException("å¯†ç éªŒè¯å¤±è´¥", e);
        }
    }
}
```

### 2. JWT Tokenç”Ÿæˆ
```java
public class JwtUtil {
    private static final String SECRET = "your_jwt_secret_key";
    private static final long EXPIRATION = 3600000; // 1å°æ—¶
    
    public static String generateToken(Integer userId, String username, Boolean isAdmin) {
        return Jwts.builder()
                .setSubject(userId.toString())
                .claim("username", username)
                .claim("isAdmin", isAdmin)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + EXPIRATION))
                .signWith(SignatureAlgorithm.HS512, SECRET)
                .compact();
    }
    
    public static Claims validateToken(String token) {
        try {
            return Jwts.parser()
                    .setSigningKey(SECRET)
                    .parseClaimsJws(token)
                    .getBody();
        } catch (Exception e) {
            return null;
        }
    }
}
```

### 3. ç»Ÿä¸€å“åº”æ ¼å¼
```java
public class ApiResponse<T> {
    private boolean success;
    private String message;    // ä»…å¤±è´¥æ—¶æœ‰
    private T data;            // ä»…æˆåŠŸæ—¶æœ‰
    
    // é™æ€å·¥å‚æ–¹æ³•
    public static <T> ApiResponse<T> success(T data) {
        ApiResponse<T> response = new ApiResponse<>();
        response.setSuccess(true);
        response.setData(data);
        return response;
    }
    
    public static ApiResponse<Void> error(String message) {
        ApiResponse<Void> response = new ApiResponse<>();
        response.setSuccess(false);
        response.setMessage(message);
        return response;
    }
    
    // getters and setters
}
```

### 4. TokenéªŒè¯è¿‡æ»¤å™¨
```java
@WebFilter("/api/*")
public class TokenFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) 
            throws IOException, ServletException {
        
        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) res;
        
        // ç™½åå•ï¼šç™»å½•å’Œå…¬å¼€API
        String path = request.getRequestURI();
        if (path.endsWith("/api/auth/login")) {
            chain.doFilter(request, response);
            return;
        }
        
        // éªŒè¯Token
        String token = extractToken(request);
        if (token == null) {
            sendError(response, 401, "éœ€è¦èº«ä»½éªŒè¯");
            return;
        }
        
        Claims claims = JwtUtil.validateToken(token);
        if (claims == null) {
            sendError(response, 401, "Tokenæ— æ•ˆæˆ–å·²è¿‡æœŸ");
            return;
        }
        
        // è®¾ç½®ç”¨æˆ·ä¸Šä¸‹æ–‡
        Integer userId = Integer.parseInt(claims.getSubject());
        request.setAttribute("userId", userId);
        
        chain.doFilter(request, response);
    }
    
    private String extractToken(HttpServletRequest request) {
        String header = request.getHeader("Authorization");
        if (header != null && header.startsWith("Bearer ")) {
            return header.substring(7);
        }
        return null;
    }
}
```

### 5. UserServletæ ¸å¿ƒé€»è¾‘
```java
@WebServlet("/api/*")
public class UserServlet extends BaseServlet {
    private final UserDAO userDAO = new UserDAO();
    
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        String path = req.getPathInfo();
        
        if ("/auth/login".equals(path)) {
            handleLogin(req, resp);
        } else if ("/auth/logout".equals(path)) {
            handleLogout(req, resp);
        } else {
            sendError(resp, 404, "APIä¸å­˜åœ¨");
        }
    }
    
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        String path = req.getPathInfo();
        
        if ("/user/permissions".equals(path)) {
            handleGetPermissions(req, resp);
        } else {
            sendError(resp, 404, "APIä¸å­˜åœ¨");
        }
    }
    
    @Override
    protected void doPut(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        String path = req.getPathInfo();
        
        if ("/user/profile".equals(path)) {
            handleUpdateProfile(req, resp);
        } else {
            sendError(resp, 404, "APIä¸å­˜åœ¨");
        }
    }
    
    private void handleLogin(HttpServletRequest req, HttpServletResponse resp) 
            throws IOException {
        
        // è§£æè¯·æ±‚
        LoginRequest loginReq = parseJsonBody(req, LoginRequest.class);
        
        // æŸ¥è¯¢ç”¨æˆ·
        SystemUser user = userDAO.findByUsername(loginReq.getUsername());
        if (user == null) {
            sendJsonResponse(resp, 401, ApiResponse.error("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"));
            return;
        }
        
        // éªŒè¯å¯†ç 
        boolean valid = SecurityUtil.verifyPassword(
            loginReq.getPassword(),
            user.getPasswordHash(),
            user.getSalt()
        );
        
        if (!valid) {
            sendJsonResponse(resp, 401, ApiResponse.error("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"));
            return;
        }
        
        // æ£€æŸ¥çŠ¶æ€
        if (user.getStatus() != 1) {
            sendJsonResponse(resp, 403, ApiResponse.error("ç”¨æˆ·å·²è¢«ç¦ç”¨"));
            return;
        }
        
        // ç”ŸæˆToken
        String token = JwtUtil.generateToken(
            user.getId(),
            user.getUsername(),
            user.getAdmin()
        );
        
        // æ›´æ–°ç™»å½•æ—¶é—´
        userDAO.updateLastLoginTime(user.getId());
        
        // è¿”å›å“åº”
        LoginResponse loginResp = new LoginResponse();
        loginResp.setToken(token);
        
        UserInfo userInfo = new UserInfo();
        userInfo.setId(user.getId());
        userInfo.setUsername(user.getUsername());
        userInfo.setRealName(user.getRealName());
        userInfo.setAdmin(user.getAdmin());
        loginResp.setUser(userInfo);
        
        sendJsonResponse(resp, 200, ApiResponse.success(loginResp));
    }
    
    private void handleGetPermissions(HttpServletRequest req, HttpServletResponse resp) 
            throws IOException {
        
        Integer userId = (Integer) req.getAttribute("userId");
        SystemUser user = userDAO.findById(userId);
        
        PermissionResponse permissions = new PermissionResponse();
        permissions.setAdmin(user.getAdmin());
        permissions.setCanManageOrder(user.getCanManageOrder());
        permissions.setCanManageLogistics(user.getCanManageLogistics());
        permissions.setCanManageAfterSales(user.getCanManageAfterSales());
        permissions.setCanManageReview(user.getCanManageReview());
        permissions.setCanManageInventory(user.getCanManageInventory());
        permissions.setCanManageIncome(user.getCanManageIncome());
        
        sendJsonResponse(resp, 200, ApiResponse.success(permissions));
    }
    
    private void handleUpdateProfile(HttpServletRequest req, HttpServletResponse resp) 
            throws IOException {
        
        Integer userId = (Integer) req.getAttribute("userId");
        UpdateProfileRequest updateReq = parseJsonBody(req, UpdateProfileRequest.class);
        
        // æ•°æ®éªŒè¯
        if (!updateReq.hasUpdateFields()) {
            sendJsonResponse(resp, 400, ApiResponse.error("è‡³å°‘éœ€è¦ä¸€ä¸ªæ›´æ–°å­—æ®µ"));
            return;
        }
        
        // é‚®ç®±å”¯ä¸€æ€§æ£€æŸ¥
        if (updateReq.getEmail() != null) {
            SystemUser existing = userDAO.findByEmail(updateReq.getEmail());
            if (existing != null && !existing.getId().equals(userId)) {
                sendJsonResponse(resp, 409, ApiResponse.error("é‚®ç®±å·²è¢«ä½¿ç”¨"));
                return;
            }
        }
        
        // æ›´æ–°ç”¨æˆ·
        SystemUser user = userDAO.findById(userId);
        if (updateReq.getRealName() != null) {
            user.setRealName(updateReq.getRealName());
        }
        if (updateReq.getEmail() != null) {
            user.setEmail(updateReq.getEmail());
        }
        if (updateReq.getPhone() != null) {
            user.setPhone(updateReq.getPhone());
        }
        
        boolean success = userDAO.update(user);
        if (!success) {
            sendJsonResponse(resp, 500, ApiResponse.error("æ›´æ–°å¤±è´¥"));
            return;
        }
        
        // è¿”å›æ›´æ–°åçš„ä¿¡æ¯
        ProfileResponse profileResp = new ProfileResponse();
        profileResp.setId(user.getId());
        profileResp.setRealName(user.getRealName());
        profileResp.setEmail(user.getEmail());
        profileResp.setPhone(user.getPhone());
        
        sendJsonResponse(resp, 200, ApiResponse.success(profileResp));
    }
    
    private void handleLogout(HttpServletRequest req, HttpServletResponse resp) 
            throws IOException {
        // æ— çŠ¶æ€å®ç°ï¼šå®¢æˆ·ç«¯ä¸¢å¼ƒTokenå³å¯
        sendJsonResponse(resp, 200, ApiResponse.success(null));
    }
}
```

### 6. DTOç±»ï¼ˆç®€æ´ç‰ˆï¼‰

```java
// ç™»å½•è¯·æ±‚
public class LoginRequest {
    private String username;
    private String password;
    // getters and setters
}

// ç™»å½•å“åº”
public class LoginResponse {
    private String token;
    private UserInfo user;
    // getters and setters
}

// ç”¨æˆ·ä¿¡æ¯
public class UserInfo {
    private Integer id;
    private String username;
    private String realName;
    private Boolean admin;
    // getters and setters
}

// æƒé™å“åº”
public class PermissionResponse {
    private Boolean admin;
    private Boolean canManageOrder;
    private Boolean canManageLogistics;
    private Boolean canManageAfterSales;
    private Boolean canManageReview;
    private Boolean canManageInventory;
    private Boolean canManageIncome;
    // getters and setters
}

// æ›´æ–°ä¸ªäººä¿¡æ¯è¯·æ±‚
public class UpdateProfileRequest {
    private String realName;
    private String email;
    private String phone;
    
    public boolean hasUpdateFields() {
        return realName != null || email != null || phone != null;
    }
    // getters and setters
}

// ä¸ªäººä¿¡æ¯å“åº”
public class ProfileResponse {
    private Integer id;
    private String realName;
    private String email;
    private String phone;
    // getters and setters
}
```

## ğŸ“¦ ä¾èµ–éœ€æ±‚

### Mavenä¾èµ–
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <!-- groupIdï¼š
        æ³¨æ„ï¼šè¿™æ˜¯å·¥ç¨‹ç»„çš„æ ‡è¯†ã€‚å®ƒåœ¨ä¸€ä¸ªç»„ç»‡æˆ–è€…é¡¹ç›®ä¸­é€šå¸¸æ˜¯å”¯ä¸€çš„ã€‚
        éœ€è¦åœ¨src/main/java/ä¸‹åˆ›å»ºå¯¹åº”è½¯ä»¶åŒ…,è¿™é‡Œæ˜¯com.apex,
        åˆ™æ‰€æœ‰æºä»£ç å¿…é¡»ä½äºcom.exampleåŒ…ä¸‹ã€‚
        å¯ä»¥è‡ªå®šä¹‰ä¸ºå…¶ä»–åŒ…ï¼Œæ¯”å¦‚com.myName,åŒæ ·éœ€è¦åœ¨src/main/java/ä¸‹åˆ›å»ºå¯¹åº”è½¯ä»¶åŒ…
     -->
    <groupId>com.apex</groupId>

    <!-- è¿™æ˜¯å·¥ç¨‹çš„æ ‡è¯†ã€‚å®ƒé€šå¸¸æ˜¯å·¥ç¨‹çš„åç§°ã€‚ -->
    <artifactId>ApexFlow</artifactId>

    <!-- è¿™æ˜¯å·¥ç¨‹çš„ç‰ˆæœ¬å·ã€‚åœ¨ artifact çš„ä»“åº“ä¸­ï¼Œå®ƒç”¨æ¥åŒºåˆ†ä¸åŒçš„ç‰ˆæœ¬ã€‚ -->
    <version>1.0-SNAPSHOT</version>

    <!-- æ‰“åŒ…ç±»å‹ï¼šwebé¡¹ç›®ä¸ºwar -->
    <packaging>war</packaging>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <maven.compiler.source>17</maven.compiler.source>
        <maven.compiler.target>17</maven.compiler.target>
        <servlet.version>4.0.1</servlet.version>
        <junit.version>5.9.2</junit.version>
    </properties>

    <!-- é¡¹ç›®çš„ä¾èµ–ï¼ˆä¸‹é¢å‡ ä¸ªæ˜¯å¿…é¡»çš„ä¾èµ–ï¼Œå¦‚æœè‡ªå·±ç”¨äº†å…¶ä»–åº“è‡ªè¡Œæ·»åŠ ï¼‰ -->
    <dependencies>
        <!-- Servlet API -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>${servlet.version}</version>
            <scope>provided</scope>
        </dependency>

        <!-- JSP API -->
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>javax.servlet.jsp-api</artifactId>
            <version>2.3.3</version>
            <scope>provided</scope>
        </dependency>

        <!-- JSTL API (æ ‡å‡†è§„èŒƒ) -->
        <dependency>
            <groupId>org.apache.taglibs</groupId>
            <artifactId>taglibs-standard-spec</artifactId>
            <version>1.2.5</version>
        </dependency>

        <!-- JSTL å®ç° (Apache Standard Taglibs) -->
        <dependency>
            <groupId>org.apache.taglibs</groupId>
            <artifactId>taglibs-standard-impl</artifactId>
            <version>1.2.5</version>
        </dependency>

        <!-- SLF4J API -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>2.0.9</version>
        </dependency>

        <!-- Logback å®ç° -->
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>1.5.13</version>
        </dependency>

        <!-- å¯é€‰ï¼šLogback é…ç½®æ–‡ä»¶ -->
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-core</artifactId>
            <version>1.5.19</version>
        </dependency>

        <!-- æµ‹è¯• -->
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-api</artifactId>
            <version>${junit.version}</version>
            <scope>test</scope>
        </dependency>

        <!-- H2æ•°æ®åº“ï¼ˆå¼€å‘ç”¨ï¼‰ -->
        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <version>2.2.220</version>
            <scope>runtime</scope>
        </dependency>

        <!-- MySQLæ•°æ®åº“é©±åŠ¨ -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>8.0.33</version>
        </dependency>

        <!-- è¿æ¥æ±  -->
        <dependency>
            <groupId>com.zaxxer</groupId>
            <artifactId>HikariCP</artifactId>
            <version>5.0.1</version>
        </dependency>

        <!-- å•å…ƒæµ‹è¯• -->
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter</artifactId>
            <version>5.9.2</version>
            <scope>test</scope>
        </dependency>

        <!-- jsonæ”¯æŒ -->
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.15.2</version>
        </dependency>

        <dependency>
            <groupId>com.fasterxml.jackson.datatype</groupId>
            <artifactId>jackson-datatype-jsr310</artifactId>
            <version>2.15.2</version> <!-- è¯·ä½¿ç”¨ä¸é¡¹ç›®ä¸­ Jackson ç‰ˆæœ¬å…¼å®¹çš„ç‰ˆæœ¬ -->
        </dependency>

        <!-- jetbrainsæ³¨è§£ -->
        <dependency>
            <groupId>org.jetbrains</groupId>
            <artifactId>annotations</artifactId>
            <version>RELEASE</version>
            <scope>compile</scope>
        </dependency>

        <!-- Mockito -->
        <dependency>
            <groupId>org.mockito</groupId>
            <artifactId>mockito-core</artifactId>
            <version>5.3.1</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.mockito</groupId>
            <artifactId>mockito-junit-jupiter</artifactId>
            <version>5.3.1</version>
            <scope>test</scope>
        </dependency>

        <!-- JWTä¾èµ– -->
        <!-- JWT dependencies -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-api</artifactId>
            <version>0.11.5</version>
        </dependency>

        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-impl</artifactId>
            <version>0.11.5</version>
            <scope>runtime</scope>
        </dependency>

        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-jackson</artifactId>
            <version>0.11.5</version>
            <scope>runtime</scope>
        </dependency>

        <!-- Gsonä¾èµ– -->
        <dependency>
            <groupId>com.google.code.gson</groupId>
            <artifactId>gson</artifactId>
            <version>2.10.1</version>
        </dependency>

        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>2.0.1.Final</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate.validator</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>6.2.0.Final</version>
        </dependency>

        <dependency>
            <groupId>org.glassfish</groupId>
            <artifactId>javax.el</artifactId>
            <version>3.0.0</version>
        </dependency>

    </dependencies>

    <build>
        <!-- è¾“å‡ºwaræ–‡ä»¶åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ -->
        <finalName>ApexFlow</finalName>
        <plugins>
            <!-- Maven ç¼–è¯‘æ’ä»¶ -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
                <configuration>
                    <source>17</source>
                    <target>17</target>
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>

            <!-- Maven War æ’ä»¶ -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>3.4.0</version>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>3.0.0-M5</version>
                <configuration>
                    <argLine>-Xshare:off</argLine>  <!-- ç¦ç”¨ç±»æ•°æ®å…±äº« -->
                </configuration>
            </plugin>

            <!-- Tomcat 7 æ’ä»¶ï¼ˆç”¨äº Maven è¿è¡Œï¼‰ -->
            <plugin>
                <groupId>org.apache.tomcat.maven</groupId>
                <artifactId>tomcat7-maven-plugin</artifactId>
                <version>2.2</version>
                <configuration>

                    <!-- ç«¯å£ -->
                    <port>8080</port>

                    <!--Maven è¿è¡Œ Tomcat æœåŠ¡å™¨è·¯å¾„
                    è¯·æ”¹ä¸º /artifactIdçš„å€¼-->
                    <path>/ApexFlow</path>

                    <uriEncoding>UTF-8</uriEncoding>

                </configuration>
            </plugin>
        </plugins>
    </build>
</project>

```

## ğŸš€ å¿«é€Ÿæµ‹è¯•

### æµ‹è¯•ç™»å½•
```bash
curl -X POST https://api.example.com/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"your_password"}'
```

### æµ‹è¯•æƒé™è·å–
```bash
curl -X GET https://api.example.com/api/user/permissions \
  -H "Authorization: Bearer your_jwt_token"
```

### æµ‹è¯•æ›´æ–°ä¿¡æ¯
```bash
curl -X PUT https://api.example.com/api/user/profile \
  -H "Authorization: Bearer your_jwt_token" \
  -H "Content-Type: application/json" \
  -d '{"realName":"å¼ ä¸‰","email":"zhangsan@example.com"}'
```

### ğŸ”§ PasswordHashGenerator å·¥å…·ä½¿ç”¨æ–‡æ¡£

#### ğŸ“‹ å·¥å…·æ¦‚è¿°

`PasswordHashGenerator` æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆå¯†ç ç›å€¼å’Œå“ˆå¸Œå€¼çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸“é—¨ä¸º `apexflow_system_user` æ•°æ®åº“è¡¨è®¾è®¡ã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ ï¼š
- ä¸ºç®¡ç†å‘˜è´¦æˆ·ç”Ÿæˆå®‰å…¨çš„å¯†ç å“ˆå¸Œ
- æ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨æˆ·æ•°æ®
- éªŒè¯å¯†ç å“ˆå¸Œçš„æ­£ç¡®æ€§
- ç”Ÿæˆå¯ç›´æ¥æ‰§è¡Œçš„SQLè¯­å¥

---

#### ğŸš€ å¼€å§‹

ä½¿ç”¨IDEAæ‰“å¼€apexflow_serveræ–‡ä»¶å¤¹ï¼Œå¯¼èˆªåˆ° `/src/main/java/com/apex/util/PasswordHashGenerator.java`ç›´æ¥æ‰§è¡Œ

#### ğŸ“– åŠŸèƒ½ç¤ºä¾‹

#### ğŸ“ ç¤ºä¾‹1ï¼šç”Ÿæˆå•ä¸ªå¯†ç å“ˆå¸Œï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰

**åœºæ™¯**ï¼šä¸ºç®¡ç†å‘˜è´¦æˆ· "admin" ç”Ÿæˆå¯†ç  "admin123" çš„å“ˆå¸Œå€¼

```bash
# è¿è¡Œå·¥å…·åé€‰æ‹©é€‰é¡¹1
è¯·é€‰æ‹©æ“ä½œï¼š1

è¯·è¾“å…¥ç”¨æˆ·å: admin
è¯·è¾“å…¥å¯†ç : admin123

========== ç”Ÿæˆç»“æœ ==========
ç”¨æˆ·å: admin
åŸå§‹å¯†ç : admin123
ç›å€¼ (32ä½): a1b2c3d4e5f678901234567890123456
å“ˆå¸Œå€¼: Lp7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==
================================

===== SQL æ’å…¥è¯­å¥ç¤ºä¾‹ =====
INSERT INTO apexflow_system_user (username, password_hash, salt)
VALUES ('admin', 'Lp7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==', 'a1b2c3d4e5f678901234567890123456');
==============================
```

#### ğŸ” ç¤ºä¾‹2ï¼šç”Ÿæˆéšæœºå¼ºå¯†ç 

**åœºæ™¯**ï¼šä¸ºç‰©æµç®¡ç†å‘˜ç”Ÿæˆéšæœºå¼ºå¯†ç 

```bash
# è¿è¡Œå·¥å…·åé€‰æ‹©é€‰é¡¹2
è¯·é€‰æ‹©æ“ä½œï¼š2

è¯·è¾“å…¥ç”¨æˆ·å: logistics_admin
è¯·è¾“å…¥è¦ç”Ÿæˆçš„å¯†ç é•¿åº¦ (é»˜è®¤12ä½): 16
ç”Ÿæˆå¼ºå¯†ç ï¼Ÿ(y/N): y

========== éšæœºå¯†ç ç”Ÿæˆ ==========
å·²ç”Ÿæˆéšæœºå¯†ç ï¼Œè¯·å¦¥å–„ä¿ç®¡ï¼

========== ç”Ÿæˆç»“æœ ==========
ç”¨æˆ·å: logistics_admin
åŸå§‹å¯†ç : K8$gT2xLp9mNq6zA!B3#c
ç›å€¼ (32ä½): w3XkP7tM1vQ8rZ5yA9bC2dE4fG6hJ8k
å“ˆå¸Œå€¼: tL4mN8vQ2xK7pZ9w1R3yU5iJ0oA6sDfGh7jM0OqA==
================================
```

#### ğŸ“Š ç¤ºä¾‹3ï¼šæ‰¹é‡ç”Ÿæˆæµ‹è¯•ç”¨æˆ·

**åœºæ™¯**ï¼šä¸ºæµ‹è¯•ç¯å¢ƒæ‰¹é‡ç”Ÿæˆ3ä¸ªæµ‹è¯•ç”¨æˆ·

```bash
# è¿è¡Œå·¥å…·åé€‰æ‹©é€‰é¡¹3
è¯·é€‰æ‹©æ“ä½œï¼š3

è¯·è¾“å…¥è¦ç”Ÿæˆçš„å¯†ç æ•°é‡ (1-10): 3
ç”Ÿæˆå¼ºå¯†ç ï¼Ÿ(y/N): n

è¯·è¾“å…¥ç”¨æˆ·å1: test_user1
è¯·è¾“å…¥ç”¨æˆ·å2: test_user2
è¯·è¾“å…¥ç”¨æˆ·å3: test_user3

--- ç”¨æˆ· #1 ---
ç”¨æˆ·å: test_user1
å¯†ç : AbC123!@#
ç›å€¼: x1Y2z3A4b5C6d7E8f9G0h1I2j3K4l5
å“ˆå¸Œå€¼: mN8pQ9rS2tU3vW4xY5z6A7B8C9D0E1

--- ç”¨æˆ· #2 ---
ç”¨æˆ·å: test_user2
å¯†ç : XyZ456$%^
ç›å€¼: M6n7O8p9Q0r1S2t3U4v5W6x7Y8z9A0
å“ˆå¸Œå€¼: B1C2D3E4F5G6H7I8J9K0L1M2N3O4

--- ç”¨æˆ· #3 ---
ç”¨æˆ·å: test_user3
å¯†ç : LmN789&*(
ç›å€¼: B1c2D3e4F5g6H7i8J9k0L1m2N3o4P5
å“ˆå¸Œå€¼: Q6R7S8T9U0V1W2X3Y4Z5a6b7c8d9
```

#### ğŸ—ƒï¸ ç¤ºä¾‹4ï¼šç”Ÿæˆå®Œæ•´ç”¨æˆ·SQLè¯­å¥

**åœºæ™¯**ï¼šåˆ›å»ºå…·æœ‰ç‰¹å®šæƒé™çš„è¿è¥äººå‘˜è´¦æˆ·

```bash
# è¿è¡Œå·¥å…·åé€‰æ‹©é€‰é¡¹4
è¯·é€‰æ‹©æ“ä½œï¼š4

è¯·è¾“å…¥ç”¨æˆ·å: operations
è¯·è¾“å…¥çœŸå®å§“å: è¿è¥ä¸“å‘˜
è¯·è¾“å…¥é‚®ç®±: operations@apexflow.com
è¯·è¾“å…¥æ‰‹æœºå·: 13900139001
è¯·è¾“å…¥å¯†ç : Ops@123456

è¯·è®¾ç½®æƒé™ (è¾“å…¥yè¡¨ç¤ºå¯ç”¨ï¼Œnè¡¨ç¤ºç¦ç”¨):
è¶…çº§ç®¡ç†å‘˜ (is_admin): n
è®¢å•ç®¡ç†æƒé™ (can_manage_order): y
ç‰©æµç®¡ç†æƒé™ (can_manage_logistics): y
å”®åç®¡ç†æƒé™ (can_manage_after_sales): y
è¯„ä»·ç®¡ç†æƒé™ (can_manage_review): y
åº“å­˜ç®¡ç†æƒé™ (can_manage_inventory): n
æ”¶å…¥ç®¡ç†æƒé™ (can_manage_income): n
çŠ¶æ€ (1-æ­£å¸¸, 0-ç¦ç”¨): 1

========== ç”Ÿæˆçš„SQLè¯­å¥ ==========
INSERT INTO apexflow_system_user (username, password_hash, salt, real_name, email, phone, 
is_admin, can_manage_order, can_manage_logistics, can_manage_after_sales, 
can_manage_review, can_manage_inventory, can_manage_income, status) VALUES
('operations', 'T7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==', 'q1w2e3r4t5y6u7i8o9p0a1s2d3f4g5', 
'è¿è¥ä¸“å‘˜', 'operations@apexflow.com', '13900139001', 
FALSE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, 1);
```

#### âš¡ ç¤ºä¾‹5ï¼šå¿«é€Ÿç”Ÿæˆç®¡ç†å‘˜è´¦æˆ·SQL

**åœºæ™¯**ï¼šå¿«é€Ÿåˆ›å»ºè¶…çº§ç®¡ç†å‘˜å’Œç‰©æµç®¡ç†å‘˜

```bash
# è¿è¡Œå·¥å…·åé€‰æ‹©é€‰é¡¹5
è¯·é€‰æ‹©æ“ä½œï¼š5

è¯·è¾“å…¥ç®¡ç†å‘˜ç”¨æˆ·å (é»˜è®¤admin): admin
è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç  (é»˜è®¤admin123): Admin@2024
è¯·è¾“å…¥çœŸå®å§“å (é»˜è®¤ç³»ç»Ÿç®¡ç†å‘˜): è¶…çº§ç®¡ç†å‘˜
è¯·è¾“å…¥é‚®ç®± (é»˜è®¤admin@apexflow.com): 
è¯·è¾“å…¥æ‰‹æœºå· (é»˜è®¤13800138000): 

========== ç®¡ç†å‘˜è´¦æˆ·SQLè¯­å¥ ==========
-- åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·
INSERT INTO apexflow_system_user (username, password_hash, salt, real_name, email, phone, 
is_admin, can_manage_order, can_manage_logistics, can_manage_after_sales, 
can_manage_review, can_manage_inventory, can_manage_income, status) VALUES
('admin', 'X5y6z7A8B9C0D1E2F3G4H5I6J7K8L9M0N1O2P3Q4', 'z1x2c3v4b5n6m7a8s9d0f1g2h3j4k5l6', 
'è¶…çº§ç®¡ç†å‘˜', 'admin@apexflow.com', '13800138000', 
TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, 1);

-- æµ‹è¯•ç”¨çš„æ™®é€šç‰©æµç®¡ç†å‘˜
INSERT INTO apexflow_system_user (username, password_hash, salt, real_name, email, phone, 
is_admin, can_manage_order, can_manage_logistics, can_manage_after_sales, 
can_manage_review, can_manage_inventory, can_manage_income, status) VALUES
('logistics_admin', 'X5y6z7A8B9C0D1E2F3G4H5I6J7K8L9M0N1O2P3Q4', 'z1x2c3v4b5n6m7a8s9d0f1g2h3j4k5l6', 
'ç‰©æµç®¡ç†å‘˜', 'logistics@apexflow.com', '13900139000', 
FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, 1);
```

#### âœ… ç¤ºä¾‹6ï¼šéªŒè¯å¯†ç å“ˆå¸Œ

**åœºæ™¯**ï¼šéªŒè¯æ•°æ®åº“ä¸­çš„å¯†ç æ˜¯å¦æ­£ç¡®

```bash
# è¿è¡Œå·¥å…·åé€‰æ‹©é€‰é¡¹6
è¯·é€‰æ‹©æ“ä½œï¼š6

è¯·è¾“å…¥å¯†ç : admin123
è¯·è¾“å…¥ç›å€¼: a1b2c3d4e5f678901234567890123456
è¯·è¾“å…¥æœŸæœ›çš„å“ˆå¸Œå€¼: Lp7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==

========== éªŒè¯ç»“æœ ==========
è¾“å…¥å¯†ç : admin123
ç›å€¼: a1b2c3d4e5f678901234567890123456
æœŸæœ›å“ˆå¸Œ: Lp7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==
å®é™…å“ˆå¸Œ: Lp7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==
éªŒè¯ç»“æœ: âœ“ åŒ¹é…æˆåŠŸ
å¯†ç éªŒè¯é€šè¿‡ï¼
```

---

#### ğŸ”§ é«˜çº§ç”¨æ³•

#### éäº¤äº’å¼æ‰¹é‡ç”Ÿæˆ

åˆ›å»ºä¸€ä¸ªè¾“å…¥æ–‡ä»¶ `input.txt`ï¼š

```
4
test_user1
æµ‹è¯•ç”¨æˆ·1
test1@example.com
13800000001
Test@123
y
y
y
y
y
y
y
1
0
```

ç„¶åè¿è¡Œï¼š
```bash
java -cp . com.apex.util.PasswordHashGenerator < input.txt
```

#### ç”ŸæˆH2æ•°æ®åº“æµ‹è¯•æ•°æ®

```sql
-- ä½¿ç”¨å·¥å…·ç”Ÿæˆçš„SQLå¯ä»¥ç›´æ¥æ’å…¥åˆ°H2å†…å­˜æ•°æ®åº“
INSERT INTO apexflow_system_user (username, password_hash, salt, is_admin, status) VALUES
('test_admin', 'Lp7mN9vQ2xK4pZ8w1R3yU5iJ0oA6sDfGh7jM0OqA==', 'a1b2c3d4e5f678901234567890123456', TRUE, 1);
```

---

#### âš ï¸ æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æé†’**
   - ç”Ÿæˆçš„å¯†ç å’Œç›å€¼è¯·å¦¥å–„ä¿ç®¡
   - ç”Ÿäº§ç¯å¢ƒè¯·å‹¿ä½¿ç”¨ç¤ºä¾‹å¯†ç 
   - å®šæœŸæ›´æ¢ç®¡ç†å‘˜å¯†ç 

2. **æ•°æ®åº“å…¼å®¹æ€§**
   - ç”Ÿæˆçš„SQLé€‚ç”¨äºMySQLã€PostgreSQLã€H2ç­‰æ•°æ®åº“
   - ç¡®ä¿æ•°æ®åº“è¡¨ç»“æ„ä¸ `apexflow_system_user` ä¸€è‡´
   - ç›å€¼å¿…é¡»æ˜¯32ä½å­—ç¬¦ä¸²

3. **æµ‹è¯•å»ºè®®**
   ```bash
   # åœ¨é›†æˆæµ‹è¯•ä¸­ä½¿ç”¨
   @BeforeAll
   static void setupTestUsers() {
       // ä½¿ç”¨å·¥å…·ç”Ÿæˆçš„å“ˆå¸Œå€¼åˆå§‹åŒ–æµ‹è¯•æ•°æ®åº“
   }
   ```

---

#### ğŸ¯ å¸¸è§ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šåˆå§‹åŒ–æ–°ç³»ç»Ÿ
```bash
# ç”Ÿæˆç®¡ç†å‘˜è´¦æˆ·
echo "åˆå§‹åŒ–ç®¡ç†å‘˜è´¦æˆ·..."
java -cp . com.apex.util.PasswordHashGenerator <<EOF > init_admin.sql
5
admin
ChangeMe@2024
ç³»ç»Ÿç®¡ç†å‘˜
admin@company.com
13800138000
0
EOF
```

#### åœºæ™¯2ï¼šåˆ›å»ºæµ‹è¯•æ•°æ®
```bash
# æ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨æˆ·
for i in {1..5}; do
  echo "ç”Ÿæˆæµ‹è¯•ç”¨æˆ·$i..."
  # ä½¿ç”¨å·¥å…·ç”Ÿæˆå¹¶ä¿å­˜åˆ°æ–‡ä»¶
done
```

#### åœºæ™¯3ï¼šå¯†ç è¿ç§»
```bash
# éªŒè¯ç°æœ‰ç”¨æˆ·å¯†ç 
echo "éªŒè¯ç”¨æˆ·å¯†ç å“ˆå¸Œ..."
java -cp . com.apex.util.PasswordHashGenerator <<EOF
6
old_password
existing_salt_from_db
existing_hash_from_db
0
EOF
```

---

#### ğŸ“Š è¾“å‡ºæ ¼å¼è¯´æ˜

å·¥å…·è¾“å‡ºçš„æ ¼å¼å¦‚ä¸‹ï¼š

1. **ç”Ÿæˆç»“æœ**ï¼šæ˜¾ç¤ºç”¨æˆ·åã€å¯†ç ã€ç›å€¼å’Œå“ˆå¸Œå€¼
2. **SQLè¯­å¥**ï¼šå¯ç›´æ¥æ‰§è¡Œçš„INSERTè¯­å¥
3. **éªŒè¯ç»“æœ**ï¼šæ˜¾ç¤ºåŒ¹é…çŠ¶æ€å’Œè¯¦ç»†ä¿¡æ¯

æ‰€æœ‰ç”Ÿæˆçš„ç›å€¼å‡ä¸º32ä½å­—ç¬¦ä¸²ï¼Œç¬¦åˆ `apexflow_system_user` è¡¨çš„è®¾è®¡è¦æ±‚ã€‚

---

**æç¤º**ï¼šæ­¤å·¥å…·ä¸»è¦ç”¨äºå¼€å‘ã€æµ‹è¯•å’Œæ•°æ®åº“åˆå§‹åŒ–é˜¶æ®µã€‚ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨æ›´å®‰å…¨çš„å¯†ç ç®¡ç†ç­–ç•¥ã€‚

## ğŸ§ª æµ‹è¯•

### å•å…ƒæµ‹è¯•
```bash
# è¿è¡Œåç«¯å•å…ƒæµ‹è¯•
cd apexflow-server
mvn test

# è¿è¡Œå‰ç«¯å•å…ƒæµ‹è¯•
cd ../apexflow-web
npm run test:unit
```

### é›†æˆæµ‹è¯•
```bash
# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
cd apexflow_web
npm run test:e2e
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼å‚ä¸é¡¹ç›®æ­¥éª¤å¦‚ä¸‹ï¼š

1. **Fork é¡¹ç›®**ï¼šç‚¹å‡»å³ä¸Šè§’çš„ForkæŒ‰é’®
2. **å…‹éš†ä»“åº“**ï¼š`git clone https://github.com/Yuriltlef/ApexFlow`
3. **åˆ›å»ºåˆ†æ”¯**ï¼š`git checkout -b feature/your-feature-name`
4. **æäº¤æ›´æ”¹**ï¼š`git commit -m 'Add some feature'`
5. **æ¨é€åˆ°åˆ†æ”¯**ï¼š`git push origin feature/your-feature-name`
6. **æäº¤Pull Request**

### å¼€å‘è§„èŒƒ
- Javaä»£ç éµå¾ªé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ
- Vueç»„ä»¶ä½¿ç”¨ç»„åˆå¼APIç¼–å†™
- æ–°å¢åŠŸèƒ½éœ€åŒ…å«ç›¸åº”çš„å•å…ƒæµ‹è¯•

### ä»£ç æäº¤ç±»å‹
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº **GNU General Public License v3.0** å¼€æºåè®®å‘å¸ƒã€‚

```
ApexFlow - ç”µå•†ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ
Copyright (C) 2023 ApexFlow Contributors

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
```

## ğŸ“ æ”¯æŒä¸è”ç³»

- **é¡¹ç›®ä¸»é¡µ**: [https://github.com/Yuriltlef/ApexFlow](https://github.com/Yuriltlef/ApexFlow)
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/Yuriltlef/ApexFlow/issues)
- **è®¨è®ºåŒº**: [GitHub Discussions](https://github.com/Yuriltlef/ApexFlow/discussions)
- **é‚®ç®±**: yurilt15312@outlook.com

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ä¸ºApexFlowæä¾›æ”¯æŒï¼š
- [Vue.js](https://vuejs.org/)
- [Element Plus](https://element-plus.org/)
- [Apache Tomcat](https://tomcat.apache.org/)
- [MySQL](https://www.mysql.com/)

è‡´è°¢æœ¬ç»„å¼€å‘äººå‘˜ï¼ï¼ï¼

---

**ApexFlow** - ç®€åŒ–ç”µå•†ç®¡ç†ï¼Œæå‡è¿è¥æ•ˆç‡ï¼